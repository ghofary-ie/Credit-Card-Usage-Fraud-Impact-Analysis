<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="light" />
    <title>Credit Card Usage &amp; Fraud Impact Analysis</title>

    <!-- Prism CSS (syntax highlighting) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism.min.css" />

    <style>
      :root {
        --accent-h: 152;
        --accent-s: 60%;
        --accent-l: 42%;
        --accent: hsl(var(--accent-h), var(--accent-s), var(--accent-l));
        --accent-600: hsl(var(--accent-h), calc(var(--accent-s) + 8%), calc(var(--accent-l) - 4%));
        --accent-300: hsl(var(--accent-h), calc(var(--accent-s) - 15%), 70%);
        --ink: #0f2a1e;
        --ink-soft: #25563f;
        --bg-start: #f2fcf6;
        --bg-end: #e7f7ef;
        --glass-fill-1: rgba(255, 255, 255, 0.55);
        --glass-fill-2: rgba(255, 255, 255, 0.32);
        --glass-border: rgba(255, 255, 255, 0.55);
        --shadow: 0 10px 30px rgba(34, 197, 94, 0.18), 0 2px 8px rgba(17, 94, 50, 0.08);
        --radius-xl: 20px;
        --radius-lg: 16px;
      }

      * { box-sizing: border-box; }
      html, body { height: 100%; }

      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, "SF Pro Display", "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--ink);
        background:
          radial-gradient(1200px 800px at -10% -20%, rgba(34, 197, 94, 0.18), transparent 60%),
          radial-gradient(900px 700px at 110% -10%, rgba(52, 211, 153, 0.16), transparent 60%),
          radial-gradient(900px 700px at 50% 120%, rgba(74, 222, 128, 0.14), transparent 60%),
          linear-gradient(180deg, var(--bg-start), var(--bg-end));
        background-attachment: fixed;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      .container { max-width: 1100px; margin: 6vh auto 8vh; padding: 0 24px; }

      .hero {
        position: relative;
        border-radius: var(--radius-xl);
        background: linear-gradient(135deg, var(--glass-fill-1), var(--glass-fill-2));
        backdrop-filter: blur(16px) saturate(160%);
        -webkit-backdrop-filter: blur(16px) saturate(160%);
        border: 1px solid var(--glass-border);
        box-shadow: var(--shadow);
        padding: 40px 32px;
        overflow: hidden;
      }

      .hero::after {
        content: "";
        position: absolute;
        inset: 0;
        border-radius: inherit;
        background: radial-gradient(600px 300px at 0% 0%, rgba(34, 197, 94, 0.22), transparent 50%),
                    radial-gradient(800px 400px at 100% 0%, rgba(16, 185, 129, 0.18), transparent 55%);
        pointer-events: none;
        mix-blend-mode: soft-light;
      }

      .badge {
        display: inline-block;
        padding: 8px 12px;
        border-radius: 999px;
        background: linear-gradient(180deg, rgba(16, 185, 129, 0.15), rgba(16, 185, 129, 0.10));
        border: 1px solid rgba(16, 185, 129, 0.25);
        color: var(--ink-soft);
        font-weight: 600;
        letter-spacing: 0.2px;
        font-size: 12px;
        backdrop-filter: blur(6px);
        -webkit-backdrop-filter: blur(6px);
      }

      h1.title {
        margin: 14px 0 10px;
        font-size: clamp(28px, 5vw, 46px);
        line-height: 1.08;
        letter-spacing: -0.02em;
        background: linear-gradient(90deg, var(--accent-600) 0%, hsl(var(--accent-h), 70%, 45%) 45%, #86efac 100%);
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        color: transparent;
        text-shadow: 0 8px 30px rgba(16, 185, 129, 0.25);
        font-weight: 800;
      }

      .author {
        margin: 6px 0 8px;
        font-weight: 700;
        color: rgba(15, 42, 30, 0.85);
        letter-spacing: 0.2px;
      }

      .lead {
        margin: 0 0 14px;
        font-size: 15px;
        line-height: 1.7;
        color: rgba(15, 42, 30, 0.78);
        text-align: justify;
        text-justify: inter-word;
      }

      p.subtitle {
        margin: 0 0 18px;
        font-size: 15px;
        color: rgba(15, 42, 30, 0.75);
      }

      .section-title {
        margin: 18px 0 10px;
        font-size: clamp(18px, 2.2vw, 22px);
        font-weight: 800;
        letter-spacing: -0.01em;
        background: linear-gradient(90deg, var(--accent-600), var(--accent-300));
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        color: transparent;
      }

      /* Tabs */
      .tabs { margin-top: 8px; }
      .card {
        position: relative;
        border-radius: var(--radius-lg);
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.60), rgba(255, 255, 255, 0.34));
        backdrop-filter: blur(14px) saturate(160%);
        -webkit-backdrop-filter: blur(14px) saturate(160%);
        border: 1px solid var(--glass-border);
        box-shadow: var(--shadow);
        padding: 0;
        overflow: hidden;
      }
      .card-body { padding: 16px 18px; }

      .tab-header {
        padding: 8px 10px;
        background: linear-gradient(180deg, rgba(255, 255, 255, 0.60), rgba(255, 255, 255, 0.35));
        border-bottom: 1px solid rgba(15, 42, 30, 0.12);
      }
      .tab-list {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin: 0;
      }
      .tab {
        appearance: none;
        border: 0;
        background: transparent;
        color: var(--ink);
        font-weight: 700;
        letter-spacing: 0.2px;
        padding: 10px 14px;
        border-radius: 12px;
        cursor: pointer;
        transition: transform 200ms ease, box-shadow 200ms ease, background-color 200ms ease;
      }
      .tab:hover { transform: translateY(-1px); }
      .tab:active { transform: translateY(0); }
      .tab.is-active {
        color: white;
        background: linear-gradient(180deg, var(--accent-300), var(--accent));
        box-shadow: 0 8px 20px rgba(16, 185, 129, 0.26), inset 0 1px 0 rgba(255, 255, 255, 0.35);
        border: 1px solid rgba(16, 185, 129, 0.45);
      }
      .tab-panels { padding: 16px 18px; height: auto; overflow: hidden; }
      .tab-panel { height: 100%; overflow-y: auto; }
      .tab-panel[hidden] { display: none; }

      /* Content typography */
      .panel-content { font-size: 15px; line-height: 1.7; }
      .panel-content p, .panel-content li {
        font-size: inherit; line-height: inherit; text-align: justify; text-justify: inter-word; color: rgba(15, 42, 30, 0.78);
      }
      .panel-content ul { margin: 10px 0 0 18px; }
      .panel-content li { margin: 6px 0; }

      /* Stakeholders list */
      .role-list {
        display: grid; grid-template-columns: 1fr; gap: 10px; margin-top: 10px;
      }
      .role-item {
        display: grid; grid-template-columns: 160px 1fr; gap: 12px; padding: 12px; border-radius: 12px;
        background: linear-gradient(180deg, rgba(255, 255, 255, 0.55), rgba(255, 255, 255, 0.35));
        border: 1px solid rgba(15, 42, 30, 0.12);
      }
      .role { font-weight: 800; color: var(--ink); }
      .role-details .stakeholders { font-weight: 700; color: rgba(15, 42, 30, 0.9); margin-bottom: 6px; }
      .role-details .desc { color: rgba(15, 42, 30, 0.78); }
      @media (max-width: 640px) { .role-item { grid-template-columns: 1fr; } }

      /* EDA section */
      .eda-intro {
        font-size: 15px; line-height: 1.7; color: rgba(15, 42, 30, 0.78);
        text-align: justify; text-justify: inter-word; margin: 0 0 18px;
      }

      .stepper {
        display: flex; align-items: center; gap: 14px; flex-wrap: wrap; margin: 18px 0 20px;
      }
      .step {
        display: flex; align-items: center; gap: 12px; padding: 12px 14px; border-radius: 14px;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.60), rgba(255, 255, 255, 0.34));
        border: 1px solid var(--glass-border); box-shadow: 0 6px 18px rgba(16, 185, 129, 0.12);
      }
      .step .emoji {
        width: 36px; height: 36px; border-radius: 999px; display: inline-flex; align-items: center; justify-content: center;
        background: linear-gradient(180deg, rgba(16, 185, 129, 0.15), rgba(16, 185, 129, 0.08)); border: 1px solid rgba(16, 185, 129, 0.25);
        font-size: 18px;
      }
      .step .step-text { display: flex; flex-direction: column; }
      .step .step-title { font-weight: 800; color: var(--ink); letter-spacing: 0.1px; }
      .step .step-desc { font-size: 12px; color: rgba(15, 42, 30, 0.65); }
      .arrow {
        width: 36px; height: 36px; border-radius: 999px; display: inline-flex; align-items: center; justify-content: center;
        background: linear-gradient(180deg, rgba(255,255,255,0.60), rgba(255,255,255,0.35)); border: 1px solid rgba(15, 42, 30, 0.12);
        color: var(--accent-600); font-weight: 800; box-shadow: 0 4px 12px rgba(15, 42, 30, 0.08); user-select: none;
      }
      @media (max-width: 720px) { .stepper { flex-direction: column; align-items: stretch; } .arrow { transform: rotate(90deg); } }

      /* Code chips (hover popovers) */
      .code-chips { display: flex; flex-wrap: wrap; gap: 10px; margin: 20px 0 10px; }
      .chip {
        position: relative; display: inline-flex; align-items: center; gap: 8px; padding: 8px 10px; border-radius: 12px;
        background: linear-gradient(135deg, rgba(255,255,255,0.60), rgba(255,255,255,0.34)); border: 1px solid var(--glass-border);
        box-shadow: 0 6px 16px rgba(16, 185, 129, 0.12); color: var(--ink);
        font-weight: 400; font-size: 13px; letter-spacing: 0.1px; white-space: nowrap; cursor: default; -webkit-tap-highlight-color: transparent;
      }
      .chip:focus-within { outline: 2px solid rgba(16, 185, 129, 0.35); outline-offset: 2px; }
      .popover {
        position: absolute; z-index: 10; bottom: calc(100% + 10px); left: 0; width: min(420px, 84vw); padding: 12px 14px; border-radius: 14px;
        background: linear-gradient(135deg, rgba(255,255,255,0.70), rgba(255,255,255,0.42)); border: 1px solid rgba(255,255,255,0.55);
        box-shadow: 0 14px 34px rgba(16, 185, 129, 0.22), 0 4px 14px rgba(15, 42, 30, 0.10);
        backdrop-filter: blur(16px) saturate(160%); -webkit-backdrop-filter: blur(16px) saturate(160%);
        opacity: 0; transform: translateY(6px) scale(0.98); pointer-events: none; transition: opacity 160ms ease, transform 160ms ease;
      }
      .popover::after {
        content: ""; position: absolute; top: 100%; left: 18px; border: 8px solid transparent; border-top-color: rgba(255,255,255,0.70);
        filter: drop-shadow(0 2px 2px rgba(15,42,30,0.10));
      }
      .chip:hover .popover, .chip:focus-within .popover { opacity: 1; transform: translateY(0) scale(1); pointer-events: auto; }
      .popover .title { font-weight: 800; margin: 0 0 6px; color: var(--ink); letter-spacing: 0.1px; }
      .popover pre {
        margin: 0; padding: 8px 10px; border-radius: 10px; background: rgba(255,255,255,0.55); border: 1px dashed rgba(15,42,30,0.15);
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        font-size: 12px; line-height: 1.6; color: #0a1f16; overflow: auto; max-height: 220px;
      }

      /* Net Profit section */
      .divider { height: 1px; background: rgba(15,42,30,0.10); margin: 18px 0; border: 0; }

      .eda-subtitle {
        margin: 22px 0 10px;
        font-weight: 800;
        font-size: 16px;
        line-height: 1.6;
        color: var(--ink);
      }

      .subsec-title {
        font-weight: 700;
        font-size: 15px;
        color: rgba(15, 42, 30, 0.9);
        margin: 14px 0 6px;
      }

      .definition-list { margin: 0 0 8px 18px; }
      .definition-list li { margin: 6px 0; }

      .math-formula {
        margin: 10px 0 12px;
        text-align: center;
      }

      .values-stack {
        display: flex;
        flex-direction: column;
        gap: 8px;
        margin: 8px 0 6px;
      }
      .value-row {
        display: flex;
        align-items: center;
        gap: 10px;
        padding: 10px 12px;
        border-radius: 12px;
        background: linear-gradient(135deg, rgba(255,255,255,0.62), rgba(255,255,255,0.38));
        border: 1px solid var(--glass-border);
        color: var(--ink);
        line-height: 1.6;
      }
      .value-row .emoji { min-width: 22px; }
      .value-row .label { font-weight: 700; }
      .value-row .amount { font-weight: 800; }

      .insights-box {
        margin-top: 14px;
        padding: 14px 14px 12px;
        border-radius: 14px;
        background: linear-gradient(135deg, rgba(34,197,94,0.08), rgba(16,185,129,0.10));
        border: 1px solid rgba(16,185,129,0.25);
        box-shadow: 0 8px 20px rgba(16, 185, 129, 0.12), inset 0 1px 0 rgba(255,255,255,0.48);
      }
      .insights-box ul { margin: 8px 0 0 18px; }
      .insights-box li { margin: 6px 0; }

      footer { margin-top: 28px; text-align: center; color: rgba(15, 42, 30, 0.55); font-size: 12px; }

      @media (prefers-reduced-motion: reduce) { .tab, .tab-list { transition: none; } }
    </style>
  </head>
  <body>
    <main class="container">
      <section class="hero">
        <span class="badge">Project</span>
        <h1 class="title">Credit Card Usage &amp; Fraud Impact Analysis</h1>
        <p class="author">Author: Abdul Ghofar – Data Analyst</p>
        <p class="lead">This repository presents a comprehensive credit card usage and fraud analysis pipeline for RevoBank, aimed at optimizing revenue and minimizing losses from fraudulent transactions. Built with transactional data analytics, segmentation techniques, and advanced data visualization, the project covers transaction performance summaries, gross and net income calculations after fraud, and customer persona development based on transaction patterns and fraud risk.</p>
        <p class="lead">The work demonstrates a data-driven approach to identifying high-value customer segments and potential fraud hotspots, supporting both strategic marketing initiatives and risk mitigation efforts for the bank’s performance management team.</p>
        <p class="subtitle">Glassmorphism interface in a soft green palette. Explore transaction patterns, surface anomalies, and quantify the impact of fraud.</p>

        <h2 class="section-title">Project Intro</h2>
        <div class="tabs">
          <div class="card tab-surface">
            <div class="tab-header">
              <div class="tab-list" role="tablist" aria-label="Project sections">
                <button class="tab is-active" role="tab" id="tab-background" aria-selected="true" aria-controls="panel-background">Project Background</button>
                <button class="tab" role="tab" id="tab-objective" aria-selected="false" aria-controls="panel-objective">Project Objective</button>
                <button class="tab" role="tab" id="tab-stakeholders" aria-selected="false" aria-controls="panel-stakeholders">Stakeholders</button>
                <button class="tab" role="tab" id="tab-scope" aria-selected="false" aria-controls="panel-scope">Project Scope</button>
                <button class="tab" role="tab" id="tab-problem" aria-selected="false" aria-controls="panel-problem">Problem Statement</button>
                <button class="tab" role="tab" id="tab-kpis" aria-selected="false" aria-controls="panel-kpis">KPIs</button>
              </div>
            </div>

            <div class="tab-panels">
              <section class="tab-panel" id="panel-background" role="tabpanel" aria-labelledby="tab-background">
                <div class="panel-content">
                  <p>RevoBank, a leading bank in Indonesia, aims to increase the usage of its credit card products among existing customers. As a data analyst working with the Performance Management (PM) team, the goal is to analyze customer transaction data over the past six months to better understand customer behavior and identify key segments for targeted marketing efforts.</p>
                  <p>The bank earns revenue from credit card transactions through a Merchant Discount Rate (MDR) fee, which results in a profit margin of 1.5% per transaction amount. However, fraudulent transactions can significantly impact the bank’s net income, as RevoBank absorbs the full cost of any fraud incurred.</p>
                  <p>This project involves summarizing transaction performance, calculating gross and net income after fraud, and developing user personas based on transaction patterns and fraud risk. The insights generated will support the PM team in creating effective strategies to encourage increased card usage and reduce fraud-related losses.</p>
                </div>
              </section>

              <section class="tab-panel" id="panel-objective" role="tabpanel" aria-labelledby="tab-objective" hidden>
                <div class="panel-content">
                  <p>The primary objective of this project is to analyze the credit card transaction data of RevoBank customers over the past six months to:</p>
                  <ul>
                    <li>Summarize overall sales performance and revenue generated from credit card transactions.</li>
                    <li>Assess the impact of fraudulent transactions on the bank’s net income.</li>
                    <li>Segment customers based on their transaction behavior, usage frequency, and fraud risk.</li>
                    <li>Develop detailed user personas to help the Performance Management team target marketing efforts effectively.</li>
                    <li>Provide actionable insights and recommendations to increase credit card usage and minimize fraud-related losses.</li>
                  </ul>
                </div>
              </section>

              <section class="tab-panel" id="panel-stakeholders" role="tabpanel" aria-labelledby="tab-stakeholders" hidden>
                <div class="panel-content">
                  <p>The project involves multiple teams, each playing a distinct role in ensuring its success:</p>
                  <div class="role-list" aria-label="Stakeholders list">
                    <div class="role-item">
                      <div class="role">Decision-maker</div>
                      <div class="role-details">
                        <div class="stakeholders">Head of Performance Management (PM) Team</div>
                        <div class="desc">Decides on marketing and risk strategies derived from the analysis.</div>
                      </div>
                    </div>
                    <div class="role-item">
                      <div class="role">Accountable</div>
                      <div class="role-details">
                        <div class="stakeholders">Project Manager (PM Team)</div>
                        <div class="desc">Ensures the project meets objectives, aligns with business strategy, and delivers actionable insights.</div>
                      </div>
                    </div>
                    <div class="role-item">
                      <div class="role">Responsible</div>
                      <div class="role-details">
                        <div class="stakeholders">Data Analyst</div>
                        <div class="desc">Conducts data cleaning, analysis, visualization, income calculation (gross &amp; net after fraud), and builds customer personas.</div>
                      </div>
                    </div>
                    <div class="role-item">
                      <div class="role">Consulted</div>
                      <div class="role-details">
                        <div class="stakeholders">Risk Management, Marketing, IT/Data Engineering</div>
                        <div class="desc">Consulted on fraud detection and financial exposure; aligning personas with targeted campaigns; data extraction, infrastructure, and security.</div>
                      </div>
                    </div>
                    <div class="role-item">
                      <div class="role">Informed</div>
                      <div class="role-details">
                        <div class="stakeholders">Executive Management, Customer Service Team</div>
                        <div class="desc">Kept informed on overall performance insights, revenue impact, fraud trends, and customer behavior insights that may affect service approaches.</div>
                      </div>
                    </div>
                  </div>
                </div>
              </section>

              <section class="tab-panel" id="panel-scope" role="tabpanel" aria-labelledby="tab-scope" hidden>
                <div class="panel-content">
                  <p>To achieve the objectives of analyzing RevoBank’s credit card usage and fraud impact, here is the dataset description and workflow:</p>
                  <h4>Datasets</h4>
                  <ul>
                    <li><strong>Cards Dataset</strong>: Details of RevoBank credit cards and associated limits.</li>
                    <li><strong>Users Dataset</strong>: Customer information including age and account details.</li>
                    <li><strong>Transactions Dataset</strong>: Records of all credit card transactions over the past 6 months.</li>
                    <li><strong>Fraud Dataset</strong>: Information on confirmed fraudulent transactions and their financial impact.</li>
                  </ul>
                  <h4>Workflow</h4>
                  <ul>
                    <li>Data Cleaning → Ensure quality datasets</li>
                    <li>EDA → Explore trends &amp; fraud patterns</li>
                    <li>Performance Summary → Track card usage &amp; revenue</li>
                    <li>Income Calculation → Measure gross vs. net after fraud</li>
                    <li>Segmentation → Build personas for targeting</li>
                    <li>Visualization → Deliver actionable insights</li>
                  </ul>
                </div>
              </section>

              <section class="tab-panel" id="panel-problem" role="tabpanel" aria-labelledby="tab-problem" hidden>
                <div class="panel-content">
                  <p>RevoBank needs to increase credit card usage among existing customers by analyzing 6 months of transaction and fraud data, aiming to improve revenue while reducing fraud related losses. The analysis will deliver actionable customer segments and revenue insights within the project timeline.</p>
                </div>
              </section>

              <section class="tab-panel" id="panel-kpis" role="tabpanel" aria-labelledby="tab-kpis" hidden>
                <div class="panel-content">
                  <p>To track the performance of RevoBank’s credit card products, the following KPIs measure usage, revenue, fraud impact, and customer segmentation:</p>
                  <ul>
                    <li>💳 <strong>Total Transaction Count (per Month)</strong>: measures overall card usage</li>
                    <li>💰 <strong>Gross Revenue (IDR)</strong>: revenue generated from all transactions</li>
                    <li>💵 <strong>Net Revenue after Fraud Losses (IDR)</strong>: shows real earnings after fraud impact</li>
                    <li>⚠️ <strong>Fraud Rate (%)</strong>: percentage of transactions flagged as fraudulent</li>
                    <li>📊 <strong>Customer Segmentation Metrics</strong>: usage frequency, average transaction value, fraud risk per segment</li>
                    <li>🌟 <strong>Top Revenue Generating Customer Segments</strong>: supports targeted marketing and persona development</li>
                  </ul>
                </div>
              </section>
            </div>
          </div>
        </div>

        <h2 class="section-title">Exploratory Data Analysis</h2>
        <div class="card eda-card">
          <div class="card-body">
            <p class="eda-intro">This section presents the process of preparing and analyzing RevoBank’s credit card datasets to uncover meaningful patterns and trends. It includes data cleaning to ensure accuracy and consistency, data exploration to understand transaction behaviors and customer characteristics, and insights that highlight key findings relevant to revenue, usage, and fraud risk.</p>

            <div class="stepper" role="list" aria-label="EDA steps">
              <div class="step" role="listitem" aria-label="Cleaning">
                <div class="emoji">🧹</div>
                <div class="step-text">
                  <div class="step-title">Cleaning</div>
                  <div class="step-desc">Validate, deduplicate, normalize</div>
                </div>
              </div>
              <div class="arrow" aria-hidden="true">→</div>
              <div class="step" role="listitem" aria-label="Exploratory Analysis">
                <div class="emoji">🔎</div>
                <div class="step-text">
                  <div class="step-title">Exploratory Analysis</div>
                  <div class="step-desc">Trends, distributions, anomalies</div>
                </div>
              </div>
              <div class="arrow" aria-hidden="true">→</div>
              <div class="step" role="listitem" aria-label="Insights and Observations">
                <div class="emoji">💡</div>
                <div class="step-text">
                  <div class="step-title">Insights &amp; Observations</div>
                  <div class="step-desc">Actionable findings</div>
                </div>
              </div>
            </div>

            <p class="eda-intro">Before diving into analysis, it’s important to go through the data cleaning phase, where we ensure the dataset is accurate, consistent, and ready for exploration. This step is crucial because any errors, missing values, or inconsistencies can lead to misleading insights later on. By cleaning the data first, we set a solid foundation for reliable exploratory analysis and meaningful findings. The detailed Python code used for this cleaning process is provided below.</p>

            <div class="code-chips" role="list" aria-label="Cleaning snippets">
              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Type conversion">
                🔄 Type conversion
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="title">Type conversion</div>
                  <pre><code class="language-python"># Load files
import pandas as pd
import numpy as np

users = pd.read_csv('/content/drive/MyDrive/25_FSDA_Barcelona_Abdul Ghofar/Python 25 Raw Data/INT_user_data.csv')
cards = pd.read_csv('/content/drive/MyDrive/25_FSDA_Barcelona_Abdul Ghofar/Python 25 Raw Data/INT_card_data.csv')

print(users.head())
print(cards.head())

users.info()
cards.info()

# ------- Change Card datatypes string/int64 etc -------

cards['id'] = cards['id'].astype(str)
cards['client_id'] = cards['client_id'].astype(str)
cards['card_number'] = cards['card_number'].astype(str)

cards['count_nonfraud_trx_L6M'] = cards['count_nonfraud_trx_L6M'].fillna(0).astype(int)
cards['count_fraud_trx_L6M'] = cards['count_fraud_trx_L6M'].fillna(0).astype(int)
cards['days_since_last_trx'] = cards['days_since_last_trx'].fillna(0).astype(int)

def clean_currency(series):
    return (
        series.astype(str)
        .str.replace('Rp', '', regex=False)
        .str.replace('.', '', regex=False)
        .str.strip()
        .replace('nan', np.nan)
        .astype(float)
    )

money_cols = [
    'credit_limit',
    'amt_nonfraud_trx_L6M',
    'amt_fraud_trx_L6M'
]

for col in money_cols:
    cards[col] = clean_currency(cards[col]).fillna(0)

cards['acct_open_date'] = pd.to_datetime(cards['acct_open_date'], format='%m/%Y', errors='coerce')
cards['expires'] = pd.to_datetime(cards['expires'], format='%m/%Y', errors='coerce')

print(cards.head())

cards.info()
print(cards['id'].dtype)

# ------- Change Users datatypes string/int64 etc -------

print(users['birthdate'].head(10))
print(users.dtypes)

users['birthdate'] = pd.to_datetime(users['birthdate'], errors='coerce')

print(users['birthdate'].head(10))
print(users['birthdate'].isna().sum())

print(users.dtypes)

users['id'] = users['id'].astype(str)

users.info()

def clean_currency(series):
    return (
        series.astype(str)
        .str.replace('Rp', '', regex=False)
        .str.replace(r'\.', '', regex=True)
        .str.strip()
        .replace('nan', np.nan)
        .astype(float)
    )

money_cols = ['per_capita_income', 'yearly_income', 'total_debt']

for col in money_cols:
    users[col] = clean_currency(users[col])

print(users.dtypes)</code></pre>
                </div>
              </div>

              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Data filtering">
                🗂️ Data filtering
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="title">Data filtering</div>
                  <p class="muted" style="font-size:12px;margin:0 0 6px;">
                    Inconsistent branding: "JCB", " Jcb ", "Visa ", Cleaned and uniform: "Jcb", "Visa" to ensures consistency, easier analysis
                  </p>
                  <pre><code class="language-python">categorical_cols = cards.select_dtypes(include='object').columns

# Loop and check unique values
for col in categorical_cols:
    print(f"--- {col} ---")
    print(cards[col].value_counts(dropna=False))
    print("\n")

print(cards['card_brand'])

cards['card_brand'] = cards['card_brand'].str.strip().str.title()

# print
cards['card_brand'].value_counts(dropna=False)

cards['card_brand'] = cards['card_brand'].replace('Jcb', 'JCB')</code></pre>
                </div>
              </div>

              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Missing handling">
                ⚠️ Missing handling
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="title">Missing handling</div>
                  <pre><code class="language-python">missing_percent = cards.isnull().mean() * 100
print(missing_percent)

missing_nonfraud = cards[cards['count_nonfraud_trx_L6M'].isna()]
print(missing_nonfraud)

missing_nonfraud = cards[cards['count_nonfraud_trx_L6M'].isna()]
print(missing_nonfraud)

missing_counts = cards[
    cards['count_nonfraud_trx_L6M'].isna() |
    cards['count_fraud_trx_L6M'].isna()
]

print(missing_counts)

cards['count_nonfraud_trx_L6M'] = cards['count_nonfraud_trx_L6M'].fillna(0).astype(int)
cards['count_fraud_trx_L6M'] = cards['count_fraud_trx_L6M'].fillna(0).astype(int)</code></pre>
                </div>
              </div>

              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Duplicate removal">
                🧹 Duplicate removal
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="title">Duplicate removal</div>
                  <pre><code class="language-python">duplicates = cards.duplicated()

print(f"Number of duplicate rows: {duplicates.sum()}")

cards = cards.drop_duplicates()

print(cards.isnull().sum())</code></pre>
                </div>
              </div>

              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Card removal">
                💳 Card removal
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="title">Card removal</div>
                  <pre><code class="language-python">cards['expires'] = pd.to_datetime(cards['expires'])

cutoff_date = pd.Timestamp('2025-04-30')

cards = cards[cards['expires'] > cutoff_date]

cards.reset_index(drop=True, inplace=True)

print(f"Remaining cards after dropping expired: {len(cards)}")

cards = cards[cards['credit_limit'] > 0]

print(cards.head())

cards.to_csv('cleaned_cards.csv', index=False)</code></pre>
                </div>
              </div>
            </div>

            <hr class="divider" />

            <div class="eda-subtitle"><strong>Exploratory Analysis – Net Profit</strong></div>
            <p class="eda-intro">After completing the data cleaning phase, we explored RevoBank's transaction data to uncover patterns in promo performance, revenue generation, and fraud impact. This analysis provides insights into customer behavior, transaction trends, and net profit, addressing key business objectives.</p>

            <!-- Show code chip before Key Definitions -->
            <div class="code-chips" role="list" aria-label="Net profit code">
              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Show code">
                💻 Show code
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="title">Calculate Net Profit (Last 6 Months)</div>
                  <pre><code class="language-python">from datetime import datetime
from dateutil.relativedelta import relativedelta

transactions = pd.read_pickle('/content/drive/MyDrive/25_FSDA_Barcelona_Abdul Ghofar/Python 25 Raw Data/transaction_data.pkl')
fraud_labels = pd.read_pickle('/content/drive/MyDrive/25_FSDA_Barcelona_Abdul Ghofar/Python 25 Raw Data/fraud_label.pkl')

today = datetime(2025, 3, 31)
cutoff_date = today - relativedelta(months=6)
transactions_last_6m = transactions[
    (transactions['date'] > cutoff_date) & (transactions['date'] <= today)
].copy()

transactions_last_6m = transactions_last_6m.merge(
    fraud_labels,
    left_on='id',
    right_on='transaction_id',
    how='left'
)

transactions_last_6m['target'] = transactions_last_6m['target'].fillna('No')
total_sales = transactions_last_6m['amount'].sum()

total_fraud_amount = transactions_last_6m.loc[
    transactions_last_6m['target'] == 'Yes',
    'amount'
].sum()

mdr_rate = 0.015
mdr_profit = total_sales * mdr_rate
net_profit = mdr_profit - total_fraud_amount

print(f"Cutoff Date: {cutoff_date.date()}")
print(f"Total Sales Amount: Rp{total_sales:,.0f}")
print(f"MDR Profit: Rp{mdr_profit:,.0f}")
print(f"Total Fraud Amount: Rp{total_fraud_amount:,.0f}")
print(f"Net Profit: Rp{net_profit:,.0f}")</code></pre>
                </div>
              </div>
            </div>

            <div class="subsec-title">Key Definitions</div>
            <ul class="definition-list">
              <li><strong>Total Sales Amount</strong>: Overall value of all credit card transactions.</li>
              <li><strong>MDR Profit</strong>: Transaction fees earned by the bank (Total Sales × Merchant Discount Rate).</li>
              <li><strong>Fraud Losses</strong>: Amount lost due to fraudulent transactions.</li>
              <li><strong>Net Profit</strong>: MDR Profit minus Fraud Losses; represents actual revenue retained after accounting for fraud.</li>
            </ul>

            <div class="subsec-title">Net Profit Calculation</div>
            <div class="subsec-title" style="margin-top:6px;">Formula</div>
            <div class="math-formula">
              \[
                \text{Net Profit} = \big(\text{Total Sales Amount} \times \text{MDR}\big) - \text{Fraud Losses}
              \]
            </div>

            <div class="subsec-title">Values</div>
            <div class="values-stack">
              <div class="value-row">
                <span class="emoji">💰</span>
                <span class="label">Total Sales Amount:</span>
                <span class="amount">Rp454,475,789,500</span>
              </div>
              <div class="value-row">
                <span class="emoji">📈</span>
                <span class="label">MDR Profit (1.5%):</span>
                <span class="amount">Rp6,817,136,842</span>
              </div>
              <div class="value-row">
                <span class="emoji">⚠️</span>
                <span class="label">Total Fraud Amount:</span>
                <span class="amount">Rp1,050,679,200</span>
              </div>
              <div class="value-row">
                <span class="emoji">✅</span>
                <span class="label">Net Profit:</span>
                <span class="amount">6,817,136,842 – 1,050,679,200 = Rp5,766,457,642</span>
              </div>
            </div>

            <div class="insights-box">
              <div class="subsec-title" style="margin:0; color: var(--accent-600);">Key Insights</div>
              <ul>
                <li>Fraud represents ~15% of MDR profit, indicating areas for improved risk management.</li>
                <li>Net profit demonstrates the actual revenue retained after fraud, helping guide marketing and operational strategies.</li>
              </ul>
            </div>

          </div>
        </div>
      </section>

      <footer>Built with a lightweight, iOS-inspired glass UI in soft green.</footer>
    </main>

    <script>
      (function () {
        var tabButtons = Array.prototype.slice.call(document.querySelectorAll('.tab-list .tab'));
        var panels = {};
        tabButtons.forEach(function (btn) {
          var panelId = btn.getAttribute('aria-controls');
          panels[btn.id] = document.getElementById(panelId);
        });
        var panelsWrap = document.querySelector('.tab-panels');

        function setHeightFromBackground() {
          var bg = document.getElementById('panel-background');
          var wasHidden = bg.hidden;
          if (wasHidden) bg.hidden = false;
          var h = bg.scrollHeight;
          if (wasHidden) bg.hidden = true;
          panelsWrap.style.height = h + 'px';
        }

        function activate(button) {
          tabButtons.forEach(function (b) {
            b.classList.remove('is-active');
            b.setAttribute('aria-selected', 'false');
            var p = panels[b.id];
            if (p) p.hidden = true;
          });
          button.classList.add('is-active');
          button.setAttribute('aria-selected', 'true');
          var current = panels[button.id];
          if (current) current.hidden = false;
        }

        function debounce(fn, wait) {
          var t;
          return function () { clearTimeout(t); t = setTimeout(fn, wait); };
        }

        tabButtons.forEach(function (btn, idx) {
          btn.addEventListener('click', function () { activate(btn); });
          btn.addEventListener('keydown', function (e) {
            if (e.key === 'ArrowRight' || e.key === 'ArrowLeft') {
              e.preventDefault();
              var dir = e.key === 'ArrowRight' ? 1 : -1;
              var next = (idx + dir + tabButtons.length) % tabButtons.length;
              activate(tabButtons[next]);
              tabButtons[next].focus();
            }
          });
        });

        window.addEventListener('load', setHeightFromBackground);
        window.addEventListener('resize', debounce(setHeightFromBackground, 150));
        setTimeout(setHeightFromBackground, 300);
      })();
    </script>

    <!-- Prism JS (syntax highlighting) -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-python.min.js"></script>
    <!-- MathJax (LaTeX rendering) -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  </body>
</html>
