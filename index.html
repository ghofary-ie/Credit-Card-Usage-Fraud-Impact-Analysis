<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="color-scheme" content="light" />
    <title>Credit Card Usage &amp; Fraud Impact Analysis (Draft)</title>

    <!-- Prism CSS (syntax highlighting) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs/themes/prism.min.css" />
    
    <!-- Plotly.js -->
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>


    <style>
      :root {
        --accent-h: 152;
        --accent-s: 60%;
        --accent-l: 42%;
        --accent: hsl(var(--accent-h), var(--accent-s), var(--accent-l));
        --accent-600: hsl(var(--accent-h), calc(var(--accent-s) + 8%), calc(var(--accent-l) - 4%));
        --accent-300: hsl(var(--accent-h), calc(var(--accent-s) - 15%), 70%);
        --ink: #0f2a1e;
        --ink-soft: #25563f;
        --bg-start: #f2fcf6;
        --bg-end: #e7f7ef;
        --glass-fill-1: rgba(255, 255, 255, 0.55);
        --glass-fill-2: rgba(255, 255, 255, 0.32);
        --glass-border: rgba(255, 255, 255, 0.55);
        --shadow: 0 10px 30px rgba(34, 197, 94, 0.18), 0 2px 8px rgba(17, 94, 50, 0.08);
        --radius-xl: 20px;
        --radius-lg: 16px;
      }

      * { box-sizing: border-box; }
      html, body { height: 100%; }

      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, "SF Pro Display", "Segoe UI", Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
        color: var(--ink);
        background:
          radial-gradient(1200px 800px at -10% -20%, rgba(34, 197, 94, 0.18), transparent 60%),
          radial-gradient(900px 700px at 110% -10%, rgba(52, 211, 153, 0.16), transparent 60%),
          radial-gradient(900px 700px at 50% 120%, rgba(74, 222, 128, 0.14), transparent 60%),
          linear-gradient(180deg, var(--bg-start), var(--bg-end));
        background-attachment: fixed;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
      }

      .container { max-width: 1100px; margin: 6vh auto 8vh; padding: 0 24px; }

      .hero {
        position: relative;
        border-radius: var(--radius-xl);
        background: linear-gradient(135deg, var(--glass-fill-1), var(--glass-fill-2));
        backdrop-filter: blur(16px) saturate(160%);
        -webkit-backdrop-filter: blur(16px) saturate(160%);
        border: 1px solid var(--glass-border);
        box-shadow: var(--shadow);
        padding: 40px 32px;
        overflow: hidden;
      }

      .hero::after {
        content: "";
        position: absolute;
        inset: 0;
        border-radius: inherit;
        background: radial-gradient(600px 300px at 0% 0%, rgba(34, 197, 94, 0.22), transparent 50%),
                    radial-gradient(800px 400px at 100% 0%, rgba(16, 185, 129, 0.18), transparent 55%);
        pointer-events: none;
        mix-blend-mode: soft-light;
      }

      .badge {
        display: inline-block;
        padding: 8px 12px;
        border-radius: 999px;
        background: linear-gradient(180deg, rgba(16, 185, 129, 0.15), rgba(16, 185, 129, 0.10));
        border: 1px solid rgba(16, 185, 129, 0.25);
        color: var(--ink-soft);
        font-weight: 600;
        letter-spacing: 0.2px;
        font-size: 12px;
        backdrop-filter: blur(6px);
        -webkit-backdrop-filter: blur(6px);
      }

      h1.title {
        margin: 14px 0 10px;
        font-size: clamp(28px, 5vw, 46px);
        line-height: 1.08;
        letter-spacing: -0.02em;
        background: linear-gradient(90deg, var(--accent-600) 0%, hsl(var(--accent-h), 70%, 45%) 45%, #86efac 100%);
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        color: transparent;
        text-shadow: 0 8px 30px rgba(16, 185, 129, 0.25);
        font-weight: 800;
      }

      .author {
        margin: 6px 0 8px;
        font-weight: 700;
        color: rgba(15, 42, 30, 0.85);
        letter-spacing: 0.2px;
      }

      .lead {
        margin: 0 0 14px;
        font-size: 15px;
        line-height: 1.7;
        color: rgba(15, 42, 30, 0.78);
        text-align: justify;
        text-justify: inter-word;
      }

      p.subtitle {
        margin: 0 0 18px;
        font-size: 15px;
        color: rgba(15, 42, 30, 0.75);
      }

      .section-title {
        margin: 18px 0 10px;
        font-size: clamp(18px, 2.2vw, 22px);
        font-weight: 800;
        letter-spacing: -0.01em;
        background: linear-gradient(90deg, var(--accent-600), var(--accent-300));
        -webkit-background-clip: text;
        background-clip: text;
        -webkit-text-fill-color: transparent;
        color: transparent;
      }

      /* Tabs */
      .tabs { margin-top: 8px; }
      .card {
        position: relative;
        border-radius: var(--radius-lg);
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.60), rgba(255, 255, 255, 0.34));
        backdrop-filter: blur(14px) saturate(160%);
        -webkit-backdrop-filter: blur(14px) saturate(160%);
        border: 1px solid var(--glass-border);
        box-shadow: var(--shadow);
        padding: 0;
        overflow: hidden;
      }
      .card-body { padding: 16px 18px; }

      .tab-header {
        padding: 8px 10px;
        background: linear-gradient(180deg, rgba(255, 255, 255, 0.60), rgba(255, 255, 255, 0.35));
        border-bottom: 1px solid rgba(15, 42, 30, 0.12);
      }
      .tab-list {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        margin: 0;
      }
      .tab {
        appearance: none;
        border: 0;
        background: transparent;
        color: var(--ink);
        font-weight: 700;
        letter-spacing: 0.2px;
        padding: 10px 14px;
        border-radius: 12px;
        cursor: pointer;
        transition: transform 200ms ease, box-shadow 200ms ease, background-color 200ms ease;
      }
      .tab:hover { transform: translateY(-1px); }
      .tab:active { transform: translateY(0); }
      .tab.is-active {
        color: white;
        background: linear-gradient(180deg, var(--accent-300), var(--accent));
        box-shadow: 0 8px 20px rgba(16, 185, 129, 0.26), inset 0 1px 0 rgba(255, 255, 255, 0.35);
        border: 1px solid rgba(16, 185, 129, 0.45);
      }
      .tab-panels { padding: 16px 18px; height: auto; overflow: hidden; }
      .tab-panel { height: 100%; overflow-y: auto; }
      .tab-panel[hidden] { display: none; }

      /* Content typography */
      .panel-content { font-size: 15px; line-height: 1.7; }
      .panel-content p, .panel-content li {
        font-size: inherit; line-height: inherit; text-align: justify; text-justify: inter-word; color: rgba(15, 42, 30, 0.78);
      }
      .panel-content ul { margin: 10px 0 0 18px; }
      .panel-content li { margin: 6px 0; }

      /* Stakeholders list */
      .role-list {
        display: grid; grid-template-columns: 1fr; gap: 10px; margin-top: 10px;
      }
      .role-item {
        display: grid; grid-template-columns: 160px 1fr; gap: 12px; padding: 12px; border-radius: 12px;
        background: linear-gradient(180deg, rgba(255, 255, 255, 0.55), rgba(255, 255, 255, 0.35));
        border: 1px solid rgba(15, 42, 30, 0.12);
      }
      .role { font-weight: 800; color: var(--ink); }
      .role-details .stakeholders { font-weight: 700; color: rgba(15, 42, 30, 0.9); margin-bottom: 6px; }
      .role-details .desc { color: rgba(15, 42, 30, 0.78); }
      @media (max-width: 640px) { .role-item { grid-template-columns: 1fr; } }

      /* EDA section */
      .eda-intro {
        font-size: 15px; line-height: 1.7; color: rgba(15, 42, 30, 0.78);
        text-align: justify; text-justify: inter-word; margin: 0 0 18px;
      }

      .stepper {
        display: flex; align-items: center; gap: 14px; flex-wrap: wrap; margin: 18px 0 20px;
      }
      .step {
        display: flex; align-items: center; gap: 12px; padding: 12px 14px; border-radius: 14px;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.60), rgba(255, 255, 255, 0.34));
        border: 1px solid var(--glass-border); box-shadow: 0 6px 18px rgba(16, 185, 129, 0.12);
      }
      .step .emoji {
        width: 36px; height: 36px; border-radius: 999px; display: inline-flex; align-items: center; justify-content: center;
        background: linear-gradient(180deg, rgba(16, 185, 129, 0.15), rgba(16, 185, 129, 0.08)); border: 1px solid rgba(16, 185, 129, 0.25);
        font-size: 18px;
      }
      .step .step-text { display: flex; flex-direction: column; }
      .step .step-title { font-weight: 800; color: var(--ink); letter-spacing: 0.1px; }
      .step .step-desc { font-size: 12px; color: rgba(15, 42, 30, 0.65); }
      .arrow {
        width: 36px; height: 36px; border-radius: 999px; display: inline-flex; align-items: center; justify-content: center;
        background: linear-gradient(180deg, rgba(255,255,255,0.60), rgba(255,255,255,0.35)); border: 1px solid rgba(15, 42, 30, 0.12);
        color: var(--accent-600); font-weight: 800; box-shadow: 0 4px 12px rgba(15, 42, 30, 0.08); user-select: none;
      }
      @media (max-width: 720px) { .stepper { flex-direction: column; align-items: stretch; } .arrow { transform: rotate(90deg); } }

      /* Code chips (hover popovers) */
      .code-chips { display: flex; flex-wrap: wrap; gap: 10px; margin: 20px 0 10px; }
      .chip {
        position: relative; display: inline-flex; align-items: center; gap: 8px; padding: 8px 10px; border-radius: 12px;
        background: linear-gradient(135deg, rgba(255,255,255,0.60), rgba(255,255,255,0.34)); border: 1px solid var(--glass-border);
        box-shadow: 0 6px 16px rgba(16, 185, 129, 0.12); color: var(--ink);
        font-weight: 400; font-size: 13px; letter-spacing: 0.1px; white-space: nowrap; cursor: default; -webkit-tap-highlight-color: transparent;
      }
      .chip:focus-within { outline: 2px solid rgba(16, 185, 129, 0.35); outline-offset: 2px; }
      .popover {
        position: absolute; z-index: 10; bottom: calc(100% + 10px); left: 0; width: min(480px, 90vw); max-height: 80vh; padding: 12px 14px; border-radius: 14px;
        background: linear-gradient(135deg, rgba(255,255,255,0.85), rgba(255,255,255,0.65)); border: 1px solid rgba(255,255,255,0.55);
        box-shadow: 0 14px 34px rgba(16, 185, 129, 0.22), 0 4px 14px rgba(15, 42, 30, 0.10);
        backdrop-filter: blur(16px) saturate(160%); -webkit-backdrop-filter: blur(16px) saturate(160%);
        opacity: 0; transform: translateY(6px) scale(0.98); pointer-events: none; transition: opacity 160ms ease, transform 160ms ease;
        overflow-y: auto; overflow-x: hidden;
      }
      .popover::after {
        content: ""; position: absolute; top: 100%; left: 18px; border: 8px solid transparent; border-top-color: rgba(255,255,255,0.70);
        filter: drop-shadow(0 2px 2px rgba(15,42,30,0.10));
      }
      .chip:hover .popover, .chip:focus-within .popover { opacity: 1; transform: translateY(0) scale(1); pointer-events: auto; }
      .popover .title { font-weight: 800; margin: 0 0 6px; color: var(--ink); letter-spacing: 0.1px; }
      .popover pre {
        margin: 0; padding: 8px 10px; border-radius: 10px; background: rgba(255,255,255,0.55); border: 1px dashed rgba(15,42,30,0.15);
        font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
        font-size: 12px; line-height: 1.6; color: #0a1f16; max-height: 220px;
        width: 100%; overflow-x: auto; overflow-y: auto; box-sizing: border-box;
      }
      /* Ensure MathJax content doesn't overflow horizontally */
      .math-formula { overflow-x: auto; }
      .popover mjx-container { display: block; overflow-x: visible; }
      /* Dedicated horizontal scroll wrapper for calculation popover */
      .popover .calc-scroll { max-width: 100%; overflow-x: auto; overflow-y: visible; -webkit-overflow-scrolling: touch; }
      .popover .calc-inner { width: max-content; min-width: 520px; }

      /* Net Profit section */
      .divider { height: 1px; background: rgba(15,42,30,0.10); margin: 18px 0; border: 0; }

      .eda-subtitle {
        margin: 22px 0 10px;
        font-weight: 800;
        font-size: 16px;
        line-height: 1.6;
        color: var(--ink);
      }

      .subsec-title {
        font-weight: 700;
        font-size: 15px;
        color: rgba(15, 42, 30, 0.9);
        margin: 14px 0 6px;
      }

      .definition-list { margin: 0 0 8px 18px; font-size: 15px; line-height: 1.7; }
      .definition-list li { margin: 6px 0; color: rgba(15, 42, 30, 0.78); text-align: justify; text-justify: inter-word; }

      .math-formula { margin: 10px 0 12px; text-align: center; }

      .values-stack { display: flex; flex-direction: column; gap: 8px; margin: 8px 0 6px; }
      .value-row {
        display: flex; align-items: center; gap: 10px; padding: 10px 12px; border-radius: 12px;
        background: linear-gradient(135deg, rgba(255,255,255,0.62), rgba(255,255,255,0.38));
        border: 1px solid var(--glass-border); color: var(--ink); line-height: 1.6;
      }
      .value-row .emoji { min-width: 22px; }
      .value-row .label { font-weight: 700; }
      .value-row .amount { font-weight: 800; }

      /* Table-style values for better alignment */
      .values-table { display: flex; flex-direction: column; gap: 8px; margin: 8px 0 6px; }
      .values-table .vrow {
        display: grid; grid-template-columns: 28px 1fr auto; align-items: center; gap: 10px;
        padding: 10px 12px; border-radius: 12px;
        background: linear-gradient(135deg, rgba(255,255,255,0.62), rgba(255,255,255,0.38));
        border: 1px solid var(--glass-border); color: var(--ink); line-height: 1.6;
      }
      .values-table .emoji { min-width: 22px; }
      .values-table .label { font-weight: 700; }
      .values-table .amount { font-weight: 800; text-align: right; white-space: nowrap; font-variant-numeric: tabular-nums; }

      .insights-box {
        margin-top: 14px; padding: 14px 14px 12px; border-radius: 14px;
        background: linear-gradient(135deg, rgba(34,197,94,0.08), rgba(16,185,129,0.10));
        border: 1px solid rgba(16,185,129,0.25);
        box-shadow: 0 8px 20px rgba(16, 185, 129, 0.12), inset 0 1px 0 rgba(255,255,255,0.48);
      }
      .insights-box ul { margin: 8px 0 0 18px; }
      .insights-box li { margin: 6px 0; }

      footer { margin-top: 28px; text-align: center; color: rgba(15, 42, 30, 0.55); font-size: 12px; }

      @media (prefers-reduced-motion: reduce) { .tab, .tab-list { transition: none; } }
    </style>
  </head>
  <body>
    <main class="container">
      <section class="hero">
        <span class="badge">Project</span>
        <h1 class="title">Credit Card Usage &amp; Fraud Impact Analysis</h1>
        <p class="author">Author: Abdul Ghofar – Data Analyst</p>
        <p class="lead">This repository presents a comprehensive credit card usage and fraud analysis pipeline for RevoBank, aimed at optimizing revenue and minimizing losses from fraudulent transactions. Built with transactional data analytics, segmentation techniques, and advanced data visualization, the project covers transaction performance summaries, gross and net income calculations after fraud, and customer persona development based on transaction patterns and fraud risk.</p>
        <p class="lead">The work demonstrates a data-driven approach to identifying high-value customer segments and potential fraud hotspots, supporting both strategic marketing initiatives and risk mitigation efforts for the bank’s performance management team.</p>
        <p class="subtitle">Glassmorphism interface in a soft green palette. Explore transaction patterns, surface anomalies, and quantify the impact of fraud.</p>

        <h2 class="section-title">Project Intro</h2>
        <div class="tabs">
          <div class="card tab-surface">
            <div class="tab-header">
              <div class="tab-list" role="tablist" aria-label="Project sections">
                <button class="tab is-active" role="tab" id="tab-background" aria-selected="true" aria-controls="panel-background">Project Background</button>
                <button class="tab" role="tab" id="tab-objective" aria-selected="false" aria-controls="panel-objective">Project Objective</button>
                <button class="tab" role="tab" id="tab-stakeholders" aria-selected="false" aria-controls="panel-stakeholders">Stakeholders</button>
                <button class="tab" role="tab" id="tab-scope" aria-selected="false" aria-controls="panel-scope">Project Scope</button>
                <button class="tab" role="tab" id="tab-problem" aria-selected="false" aria-controls="panel-problem">Problem Statement</button>
                <button class="tab" role="tab" id="tab-kpis" aria-selected="false" aria-controls="panel-kpis">KPIs</button>
              </div>
            </div>

            <div class="tab-panels">
              <section class="tab-panel" id="panel-background" role="tabpanel" aria-labelledby="tab-background">
                <div class="panel-content">
                  <p>RevoBank, a leading bank in Indonesia, aims to increase the usage of its credit card products among existing customers. As a data analyst working with the Performance Management (PM) team, the goal is to analyze customer transaction data over the past six months to better understand customer behavior and identify key segments for targeted marketing efforts.</p>
                  <p>The bank earns revenue from credit card transactions through a Merchant Discount Rate (MDR) fee, which results in a profit margin of 1.5% per transaction amount. However, fraudulent transactions can significantly impact the bank’s net income, as RevoBank absorbs the full cost of any fraud incurred.</p>
                  <p>This project involves summarizing transaction performance, calculating gross and net income after fraud, and developing user personas based on transaction patterns and fraud risk. The insights generated will support the PM team in creating effective strategies to encourage increased card usage and reduce fraud-related losses.</p>
                </div>
              </section>

              <section class="tab-panel" id="panel-objective" role="tabpanel" aria-labelledby="tab-objective" hidden>
                <div class="panel-content">
                  <p>The primary objective of this project is to analyze the credit card transaction data of RevoBank customers over the past six months to:</p>
                  <ul>
                    <li>Summarize overall sales performance and revenue generated from credit card transactions.</li>
                    <li>Assess the impact of fraudulent transactions on the bank’s net income.</li>
                    <li>Segment customers based on their transaction behavior, usage frequency, and fraud risk.</li>
                    <li>Develop detailed user personas to help the Performance Management team target marketing efforts effectively.</li>
                    <li>Provide actionable insights and recommendations to increase credit card usage and minimize fraud-related losses.</li>
                  </ul>
                </div>
              </section>

              <section class="tab-panel" id="panel-stakeholders" role="tabpanel" aria-labelledby="tab-stakeholders" hidden>
                <div class="panel-content">
                  <p>The project involves multiple teams, each playing a distinct role in ensuring its success:</p>
                  <div class="role-list" aria-label="Stakeholders list">
                    <div class="role-item">
                      <div class="role">Decision-maker</div>
                      <div class="role-details">
                        <div class="stakeholders">Head of Performance Management (PM) Team</div>
                        <div class="desc">Decides on marketing and risk strategies derived from the analysis.</div>
                      </div>
                    </div>
                    <div class="role-item">
                      <div class="role">Accountable</div>
                      <div class="role-details">
                        <div class="stakeholders">Project Manager (PM Team)</div>
                        <div class="desc">Ensures the project meets objectives, aligns with business strategy, and delivers actionable insights.</div>
                      </div>
                    </div>
                    <div class="role-item">
                      <div class="role">Responsible</div>
                      <div class="role-details">
                        <div class="stakeholders">Data Analyst</div>
                        <div class="desc">Conducts data cleaning, analysis, visualization, income calculation (gross &amp; net after fraud), and builds customer personas.</div>
                      </div>
                    </div>
                    <div class="role-item">
                      <div class="role">Consulted</div>
                      <div class="role-details">
                        <div class="stakeholders">Risk Management, Marketing, IT/Data Engineering</div>
                        <div class="desc">Consulted on fraud detection and financial exposure; aligning personas with targeted campaigns; data extraction, infrastructure, and security.</div>
                      </div>
                    </div>
                    <div class="role-item">
                      <div class="role">Informed</div>
                      <div class="role-details">
                        <div class="stakeholders">Executive Management, Customer Service Team</div>
                        <div class="desc">Kept informed on overall performance insights, revenue impact, fraud trends, and customer behavior insights that may affect service approaches.</div>
                      </div>
                                </div>
          </div>
        </div>
      </section>



              <section class="tab-panel" id="panel-scope" role="tabpanel" aria-labelledby="tab-scope" hidden>
                <div class="panel-content">
                  <p>To achieve the objectives of analyzing RevoBank’s credit card usage and fraud impact, here is the dataset description and workflow:</p>
                  <h4>Datasets</h4>
                  <ul>
                    <li><strong>Cards Dataset</strong>: Details of RevoBank credit cards and associated limits.</li>
                    <li><strong>Users Dataset</strong>: Customer information including age and account details.</li>
                    <li><strong>Transactions Dataset</strong>: Records of all credit card transactions over the past 6 months.</li>
                    <li><strong>Fraud Dataset</strong>: Information on confirmed fraudulent transactions and their financial impact.</li>
                  </ul>
                  <h4>Workflow</h4>
                  <ul>
                    <li>Data Cleaning → Ensure quality datasets</li>
                    <li>EDA → Explore trends &amp; fraud patterns</li>
                    <li>Performance Summary → Track card usage &amp; revenue</li>
                    <li>Income Calculation → Measure gross vs. net after fraud</li>
                    <li>Segmentation → Build personas for targeting</li>
                    <li>Visualization → Deliver actionable insights</li>
                  </ul>
                </div>
              </section>

              <section class="tab-panel" id="panel-problem" role="tabpanel" aria-labelledby="tab-problem" hidden>
                <div class="panel-content">
                  <p>RevoBank needs to increase credit card usage among existing customers by analyzing 6 months of transaction and fraud data, aiming to improve revenue while reducing fraud related losses. The analysis will deliver actionable customer segments and revenue insights within the project timeline.</p>
                </div>
              </section>

              <section class="tab-panel" id="panel-kpis" role="tabpanel" aria-labelledby="tab-kpis" hidden>
                <div class="panel-content">
                  <p>To track the performance of RevoBank’s credit card products, the following KPIs measure usage, revenue, fraud impact, and customer segmentation:</p>
                  <ul>
                    <li>💳 <strong>Total Transaction Count (per Month)</strong>: measures overall card usage</li>
                    <li>💰 <strong>Gross Revenue (IDR)</strong>: revenue generated from all transactions</li>
                    <li>💵 <strong>Net Revenue after Fraud Losses (IDR)</strong>: shows real earnings after fraud impact</li>
                    <li>⚠️ <strong>Fraud Rate (%)</strong>: percentage of transactions flagged as fraudulent</li>
                    <li>📊 <strong>Customer Segmentation Metrics</strong>: usage frequency, average transaction value, fraud risk per segment</li>
                    <li>🌟 <strong>Top Revenue Generating Customer Segments</strong>: supports targeted marketing and persona development</li>
                  </ul>
                </div>
              </section>
            </div>
          </div>
        </div>

        <h2 class="section-title">Exploratory Data Analysis</h2>
        <div class="card eda-card">
          <div class="card-body">
            <p class="eda-intro">This section presents the process of preparing and analyzing RevoBank’s credit card datasets to uncover meaningful patterns and trends. It includes data cleaning to ensure accuracy and consistency, data exploration to understand transaction behaviors and customer characteristics, and insights that highlight key findings relevant to revenue, usage, and fraud risk.</p>

            <div class="stepper" role="list" aria-label="EDA steps">
              <div class="step" role="listitem" aria-label="Cleaning">
                <div class="emoji">🧹</div>
                <div class="step-text">
                  <div class="step-title">Cleaning</div>
                  <div class="step-desc">Validate, deduplicate, normalize</div>
                </div>
              </div>
              <div class="arrow" aria-hidden="true">→</div>
              <div class="step" role="listitem" aria-label="Exploratory Analysis">
                <div class="emoji">🔎</div>
                <div class="step-text">
                  <div class="step-title">Exploratory Analysis</div>
                  <div class="step-desc">Trends, distributions, anomalies</div>
                </div>
              </div>
              <div class="arrow" aria-hidden="true">→</div>
              <div class="step" role="listitem" aria-label="Insights and Observations">
                <div class="emoji">💡</div>
                <div class="step-text">
                  <div class="step-title">Insights &amp; Observations</div>
                  <div class="step-desc">Actionable findings</div>
                </div>
              </div>
            </div>

            <p class="eda-intro">Before diving into analysis, it’s important to go through the data cleaning phase, where we ensure the dataset is accurate, consistent, and ready for exploration. This step is crucial because any errors, missing values, or inconsistencies can lead to misleading insights later on. By cleaning the data first, we set a solid foundation for reliable exploratory analysis and meaningful findings. The detailed Python code used for this cleaning process is provided below.</p>

            <div class="code-chips" role="list" aria-label="Cleaning snippets">
              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Type conversion">
                🔄 Type conversion
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="title">Type conversion</div>
                  <pre><code class="language-python"># Load files
import pandas as pd
import numpy as np

users = pd.read_csv('/content/drive/MyDrive/25_FSDA_Barcelona_Abdul Ghofar/Python 25 Raw Data/INT_user_data.csv')
cards = pd.read_csv('/content/drive/MyDrive/25_FSDA_Barcelona_Abdul Ghofar/Python 25 Raw Data/INT_card_data.csv')

print(users.head())
print(cards.head())

users.info()
cards.info()

# ------- Change Card datatypes string/int64 etc -------

cards['id'] = cards['id'].astype(str)
cards['client_id'] = cards['client_id'].astype(str)
cards['card_number'] = cards['card_number'].astype(str)

cards['count_nonfraud_trx_L6M'] = cards['count_nonfraud_trx_L6M'].fillna(0).astype(int)
cards['count_fraud_trx_L6M'] = cards['count_fraud_trx_L6M'].fillna(0).astype(int)
cards['days_since_last_trx'] = cards['days_since_last_trx'].fillna(0).astype(int)

def clean_currency(series):
    return (
        series.astype(str)
        .str.replace('Rp', '', regex=False)
        .str.replace('.', '', regex=False)
        .str.strip()
        .replace('nan', np.nan)
        .astype(float)
    )

money_cols = [
    'credit_limit',
    'amt_nonfraud_trx_L6M',
    'amt_fraud_trx_L6M'
]

for col in money_cols:
    cards[col] = clean_currency(cards[col]).fillna(0)

cards['acct_open_date'] = pd.to_datetime(cards['acct_open_date'], format='%m/%Y', errors='coerce')
cards['expires'] = pd.to_datetime(cards['expires'], format='%m/%Y', errors='coerce')

print(cards.head())

cards.info()
print(cards['id'].dtype)

# ------- Change Users datatypes string/int64 etc -------

print(users['birthdate'].head(10))
print(users.dtypes)

users['birthdate'] = pd.to_datetime(users['birthdate'], errors='coerce')

print(users['birthdate'].head(10))
print(users['birthdate'].isna().sum())

print(users.dtypes)

users['id'] = users['id'].astype(str)

users.info()

def clean_currency(series):
    return (
        series.astype(str)
        .str.replace('Rp', '', regex=False)
        .str.replace(r'\.', '', regex=True)
        .str.strip()
        .replace('nan', np.nan)
        .astype(float)
    )

money_cols = ['per_capita_income', 'yearly_income', 'total_debt']

for col in money_cols:
    users[col] = clean_currency(users[col])

print(users.dtypes)</code></pre>
                </div>
              </div>

              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Data filtering">
                🗂️ Data filtering
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="title">Data filtering</div>
                  <p class="muted" style="font-size:12px;margin:0 0 6px;">
                    Inconsistent branding: "JCB", " Jcb ", "Visa ", Cleaned and uniform: "Jcb", "Visa" to ensures consistency, easier analysis
                  </p>
                  <pre><code class="language-python">categorical_cols = cards.select_dtypes(include='object').columns

# Loop and check unique values
for col in categorical_cols:
    print(f"--- {col} ---")
    print(cards[col].value_counts(dropna=False))
    print("\n")

print(cards['card_brand'])

cards['card_brand'] = cards['card_brand'].str.strip().str.title()

# print
cards['card_brand'].value_counts(dropna=False)

cards['card_brand'] = cards['card_brand'].replace('Jcb', 'JCB')</code></pre>
                </div>
              </div>

              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Missing handling">
                ⚠️ Missing handling
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="title">Missing handling</div>
                  <pre><code class="language-python">missing_percent = cards.isnull().mean() * 100
print(missing_percent)

missing_nonfraud = cards[cards['count_nonfraud_trx_L6M'].isna()]
print(missing_nonfraud)

missing_nonfraud = cards[cards['count_nonfraud_trx_L6M'].isna()]
print(missing_nonfraud)

missing_counts = cards[
    cards['count_nonfraud_trx_L6M'].isna() |
    cards['count_fraud_trx_L6M'].isna()
]

print(missing_counts)

cards['count_nonfraud_trx_L6M'] = cards['count_nonfraud_trx_L6M'].fillna(0).astype(int)
cards['count_fraud_trx_L6M'] = cards['count_fraud_trx_L6M'].fillna(0).astype(int)</code></pre>
                </div>
              </div>

              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Duplicate removal">
                🧹 Duplicate removal
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="title">Duplicate removal</div>
                  <pre><code class="language-python">duplicates = cards.duplicated()

print(f"Number of duplicate rows: {duplicates.sum()}")

cards = cards.drop_duplicates()

print(cards.isnull().sum())</code></pre>
                </div>
              </div>

              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Card removal">
                💳 Card removal
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="title">Card removal</div>
                  <pre><code class="language-python">cards['expires'] = pd.to_datetime(cards['expires'])

cutoff_date = pd.Timestamp('2025-04-30')

cards = cards[cards['expires'] > cutoff_date]

cards.reset_index(drop=True, inplace=True)

print(f"Remaining cards after dropping expired: {len(cards)}")

cards = cards[cards['credit_limit'] > 0]

print(cards.head())

cards.to_csv('cleaned_cards.csv', index=False)</code></pre>
                </div>
              </div>
            </div>

            <hr class="divider" />

            <div class="eda-subtitle"><strong>Exploratory Analysis – Net Profit</strong></div>
            <p class="eda-intro">After completing the data cleaning phase, we explored RevoBank's transaction data to uncover patterns in promo performance, revenue generation, and fraud impact. This analysis provides insights into customer behavior, transaction trends, and net profit, addressing key business objectives.</p>

            <!-- Show code chip and Calculation tab side by side -->
            <div class="code-chips" role="list" aria-label="Net profit and calculation code">
              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Show code">
                💻 Show code
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="title">Calculate Net Profit (Last 6 Months)</div>
                  <pre><code class="language-python">from datetime import datetime
from dateutil.relativedelta import relativedelta

transactions = pd.read_pickle('/content/drive/MyDrive/25_FSDA_Barcelona_Abdul Ghofar/Python 25 Raw Data/transaction_data.pkl')
fraud_labels = pd.read_pickle('/content/drive/MyDrive/25_FSDA_Barcelona_Abdul Ghofar/Python 25 Raw Data/fraud_label.pkl')

today = datetime(2025, 3, 31)
cutoff_date = today - relativedelta(months=6)
transactions_last_6m = transactions[
    (transactions['date'] > cutoff_date) & (transactions['date'] <= today)
].copy()

transactions_last_6m = transactions_last_6m.merge(
    fraud_labels,
    left_on='id',
    right_on='transaction_id',
    how='left'
)

transactions_last_6m['target'] = transactions_last_6m['target'].fillna('No')
total_sales = transactions_last_6m['amount'].sum()

total_fraud_amount = transactions_last_6m.loc[
    transactions_last_6m['target'] == 'Yes',
    'amount'
].sum()

mdr_rate = 0.015
mdr_profit = total_sales * mdr_rate
net_profit = mdr_profit - total_fraud_amount

print(f"Cutoff Date: {cutoff_date.date()}")
print(f"Total Sales Amount: Rp{total_sales:,.0f}")
print(f"MDR Profit: Rp{mdr_profit:,.0f}")
print(f"Total Fraud Amount: Rp{total_fraud_amount:,.0f}")
print(f"Net Profit: Rp{net_profit:,.0f}")</code></pre>
                </div>
              </div>

              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Show calculation">
                📊 Calculation
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="calc-scroll"><div class="calc-inner">
                    <div class="title">Key Definitions & Net Profit Calculation</div>
                    <div class="subsec-title" style="margin:10px 0 6px;">Key Definitions</div>
                    <ul class="definition-list">
                      <li><strong>Total Sales Amount</strong>: Overall value of all credit card transactions.</li>
                      <li><strong>MDR Profit</strong>: Transaction fees earned by the bank (Total Sales × Merchant Discount Rate).</li>
                      <li><strong>Fraud Losses</strong>: Amount lost due to fraudulent transactions.</li>
                      <li><strong>Net Profit</strong>: MDR Profit minus Fraud Losses; represents actual revenue retained after accounting for fraud.</li>
                    </ul>
                    
                    <div class="subsec-title" style="margin:16px 0 6px;">Net Profit Calculation</div>
                    <div class="subsec-title" style="margin:6px 0 6px;">Formula</div>
                    <div class="math-formula">
                      \[
                        \text{Net Profit} = \big(\text{Total Sales Amount} \times \text{MDR}\big) - \text{Fraud Losses}
                      \]
                    </div>
                  </div></div>
                </div>
              </div>
            </div>

            <div class="subsec-title" style="text-align: center;">Values</div>
            <div style="text-align: center;">
              <table style="width: 100%; border-collapse: collapse; margin: 8px auto;">
                <thead>
                  <tr style="background: var(--accent-300);">
                    <th style="padding: 4px 6px; border: 1px solid #ddd; text-align: left; font-size: 14px; white-space: nowrap;">Metric</th>
                    <th style="padding: 4px 6px; border: 1px solid #ddd; text-align: right; font-size: 14px; white-space: nowrap;">Amount (IDR)</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td style="padding: 4px 6px; border: 1px solid #ddd; font-size: 14px; white-space: nowrap;">Total Sales Amount</td>
                    <td style="padding: 4px 6px; border: 1px solid #ddd; text-align: right; font-size: 14px; white-space: nowrap;">Rp 454,475,789,500</td>
                  </tr>
                  <tr>
                    <td style="padding: 4px 6px; border: 1px solid #ddd; font-size: 14px; white-space: nowrap;">MDR Profit (1.5%)</td>
                    <td style="padding: 4px 6px; border: 1px solid #ddd; text-align: right; font-size: 14px; white-space: nowrap;">Rp 6,817,136,842</td>
                  </tr>
                  <tr>
                    <td style="padding: 4px 6px; border: 1px solid #ddd; font-size: 14px; white-space: nowrap;">Total Fraud Amount</td>
                    <td style="padding: 4px 6px; border: 1px solid #ddd; text-align: right; font-size: 14px; white-space: nowrap;">Rp 1,050,679,200</td>
                  </tr>
                  <tr>
                    <td style="padding: 4px 6px; border: 1px solid #ddd; font-size: 14px; white-space: nowrap;">Net Profit</td>
                    <td style="padding: 4px 6px; border: 1px solid #ddd; text-align: right; font-size: 14px; white-space: nowrap;">Rp 5,766,457,642</td>
                  </tr>
                </tbody>
              </table>
            </div>

            <div class="insights-box">
              <div class="subsec-title" style="margin:0; color: var(--accent-600);">Key Insights</div>
              <ul>
                <li>Fraud represents ~15% of MDR profit, indicating areas for improved risk management.</li>
                <li>Net profit demonstrates the actual revenue retained after fraud, helping guide marketing and operational strategies.</li>
              </ul>
            </div>

            <hr class="divider" />

            <div class="eda-subtitle"><strong>Exploratory Analysis – Fraud Rate Analysis</strong></div>
            <p class="eda-intro">The fraud rate measures the proportion of fraudulent transactions relative to the total transaction volume. We calculate it by dividing the total fraud amount by the sum of all transaction amounts. A pie chart is used to visualize the share of fraud versus non-fraud transactions, making it easier to interpret the risk level for RevoBank.</p>

            <div class="code-chips" role="list" aria-label="Fraud rate code">
              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Show code">
                💻 Show code
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="title">Calculate Fraud Rate and Pie Chart</div>
                  <pre><code class="language-python">import pandas as pd
import matplotlib.pyplot as plt

transactions_with_fraud = transactions.merge(
    fraud_labels,
    left_on='id',
    right_on='transaction_id',
    how='left'
)

transactions_with_fraud['target'] = transactions_with_fraud['target'].fillna('No')

total_amount = transactions_with_fraud['amount'].sum()
total_fraud_amount = transactions_with_fraud.loc[transactions_with_fraud['target'] == 'Yes', 'amount'].sum()
total_nonfraud_amount = total_amount - total_fraud_amount

fraud_rate = (total_fraud_amount / total_amount) * 100
print(f"Fraud Rate: {fraud_rate:.4f}%")

amounts = [total_nonfraud_amount, total_fraud_amount]
labels = ['Non-Fraud', 'Fraud']
colors = ['#66b3ff', '#ff6666']

plt.figure(figsize=(6,6))
plt.pie(amounts, labels=labels, autopct='%1.2f%%', colors=colors, startangle=90)
plt.title('Fraud vs Non-Fraud Transaction Amounts')
plt.show()</code></pre>
                </div>
              </div>
            </div>


            <div style="text-align: center; margin: 20px 0;">
              <div style="position: relative; width: 300px; height: 300px; margin: 0 auto;">
                <div style="width: 240px; height: 240px; border-radius: 50%; background: conic-gradient(#66b3ff 0deg 359.17deg, #ff6666 359.17deg 360deg); margin: 0 auto; position: relative; box-shadow: 0 4px 20px rgba(0,0,0,0.15);"></div>
              </div>
              <div style="display: flex; justify-content: center; gap: 30px; margin-top: 20px; flex-wrap: wrap;">
                <div style="display: flex; align-items: center; gap: 8px;">
                  <div style="width: 16px; height: 16px; background: #66b3ff; border-radius: 50%; border: 2px solid white; box-shadow: 0 1px 3px rgba(0,0,0,0.2);"></div>
                  <span style="font-size: 14px; color: var(--ink-soft);">Non-Fraud: 99.77%</span>
                </div>
                <div style="display: flex; align-items: center; gap: 8px;">
                  <div style="width: 16px; height: 16px; background: #ff6666; border-radius: 50%; border: 2px solid white; box-shadow: 0 1px 3px rgba(0,0,0,0.2);"></div>
                  <span style="font-size: 16px; color: var(--ink-soft);">Fraud: 0.23%</span>
                </div>
              </div>
            </div>

            <div class="insights-box">
              <div class="subsec-title" style="margin:0; color: var(--accent-600);">Key Insights</div>
              <ul>
                <li>Fraud rate of 0.23% is very low compared to industry standards (≤1%), indicating effective customer protection.</li>
                <li>Fraud losses account for ~15% of MDR profit, highlighting the need for continuous fraud prevention.</li>
              </ul>
            </div>

            <hr class="divider" />

            <div class="eda-subtitle"><strong>Exploratory Analysis – Transaction Behavior</strong></div>
            <p class="eda-intro">I analyzed transaction patterns across different card brands by calculating the average transaction count and total transaction amount per brand. This allows us to compare customer activity and identify which card brands are used more frequently or generate higher transaction volumes, visualized through a clear data chart.</p>

                            <div class="code-chips" role="list" aria-label="Transaction behavior code">
                  <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Show code">
                    💻 Show code
                    <div class="popover" role="dialog" aria-hidden="true">
                      <div class="title">Analyze Transaction Behavior by Card Brand</div>
                      <pre><code class="language-python">cards.info()

import plotly.graph_objects as go
cards = pd.read_csv('/content/drive/MyDrive/25_FSDA_Barcelona_Abdul Ghofar/Python 25 Raw Data/cleaned_cards.csv')

brand_summary = cards.groupby('card_brand').agg({
    'count_nonfraud_trx_L6M': 'mean',
    'amt_nonfraud_trx_L6M': 'mean'
}).reset_index()
brand_summary.rename(columns={
    'count_nonfraud_trx_L6M': 'avg_transaction_count',
    'amt_nonfraud_trx_L6M': 'avg_transaction_amount'
}, inplace=True)

print(brand_summary)

brand_summary = cards.groupby('card_brand').agg({
    'count_nonfraud_trx_L6M': 'sum',      # <-- total number of transactions
    'amt_nonfraud_trx_L6M': 'sum'         # <-- total amount transacted
}).reset_index()

# Rename columns (optional)
brand_summary.rename(columns={
    'count_nonfraud_trx_L6M': 'avg_transaction_count',
    'amt_nonfraud_trx_L6M': 'avg_transaction_amount'
}, inplace=True)

print(brand_summary)</code></pre>
                    </div>
                  </div>
                  <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Calculation">
                    📊 Calculation
                    <div class="popover" role="dialog" aria-hidden="true">
                      <div class="title">Transaction Behavior Calculation</div>
                      <div class="calc-scroll">
                        <div class="calc-inner">
                          <div class="math-formula">
                            <h4>Given data:</h4>
                            <table style="width: 100%; border-collapse: collapse; margin: 15px 0;">
                              <thead>
                                <tr style="background: var(--accent-300);">
                                  <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">Card Brand</th>
                                  <th style="padding: 8px; border: 1px solid #ddd; text-align: right;">Total Transaction Count</th>
                                  <th style="padding: 8px; border: 1px solid #ddd; text-align: right;">Total Transaction Amount (IDR)</th>
                                </tr>
                              </thead>
                              <tbody>
                                <tr>
                                  <td style="padding: 8px; border: 1px solid #ddd;">Amex</td>
                                  <td style="padding: 8px; border: 1px solid #ddd; text-align: right;">44,565</td>
                                  <td style="padding: 8px; border: 1px solid #ddd; text-align: right;">39,038,160,000</td>
                                </tr>
                                <tr>
                                  <td style="padding: 8px; border: 1px solid #ddd;">JCB</td>
                                  <td style="padding: 8px; border: 1px solid #ddd; text-align: right;">17,301</td>
                                  <td style="padding: 8px; border: 1px solid #ddd; text-align: right;">15,380,350,000</td>
                                </tr>
                                <tr>
                                  <td style="padding: 8px; border: 1px solid #ddd;">Mastercard</td>
                                  <td style="padding: 8px; border: 1px solid #ddd; text-align: right;">342,999</td>
                                  <td style="padding: 8px; border: 1px solid #ddd; text-align: right;">226,716,100,000</td>
                                </tr>
                                <tr>
                                  <td style="padding: 8px; border: 1px solid #ddd;">Visa</td>
                                  <td style="padding: 8px; border: 1px solid #ddd; text-align: right;">245,755</td>
                                  <td style="padding: 8px; border: 1px solid #ddd; text-align: right;">174,921,900,000</td>
                                </tr>
                              </tbody>
                            </table>
                            
                            <h4>Average transaction amount per card:</h4>
                            <div style="text-align: center; margin: 20px 0;">
                              <div style="font-size: 18px; font-weight: 600; color: var(--accent-600);">
                                Avg Amount = <span style="text-decoration: overline;">Total Transaction Amount</span> ÷ <span style="text-decoration: overline;">Total Transaction Count</span>
                              </div>
                            </div>
                            
                            <div style="margin: 20px 0; text-align: left;">
                              <div style="margin-bottom: 15px;">
                                <strong>Amex:</strong> 39,038,160,000 ÷ 44,565 ≈ <span style="color: var(--accent-600); font-weight: 600;">875,000 IDR</span>
                              </div>
                              <div style="margin-bottom: 15px;">
                                <strong>JCB:</strong> 15,380,350,000 ÷ 17,301 ≈ <span style="color: var(--accent-600); font-weight: 600;">889,000 IDR</span>
                              </div>
                              <div style="margin-bottom: 15px;">
                                <strong>Mastercard:</strong> 226,716,100,000 ÷ 342,999 ≈ <span style="color: var(--accent-600); font-weight: 600;">661,000 IDR</span>
                              </div>
                              <div style="margin-bottom: 15px;">
                                <strong>Visa:</strong> 174,921,900,000 ÷ 245,755 ≈ <span style="color: var(--accent-600); font-weight: 600;">712,000 IDR</span>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>


                            <div style="text-align: center; margin: 20px 0;">
                  <div style="max-width: 800px; margin: 0 auto; padding: 20px;">

                    
                    <!-- Plotly Chart Container -->
                    <div id="254dbb66-5e49-4cd1-9055-550254b95db5" class="plotly-graph-div" style="height:500px; width:100%;"></div>
                    
                    <script type="text/javascript">
                      window.PLOTLYENV=window.PLOTLYENV || {};
                      if (document.getElementById("254dbb66-5e49-4cd1-9055-550254b95db5")) {
                        Plotly.newPlot(
                          "254dbb66-5e49-4cd1-9055-550254b95db5",
                          [{"marker":{"color":"#66b3ff"},"name":"Avg Transaction Amount","opacity":0.6,"x":["Amex","JCB","Mastercard","Visa"],"y":[98830780.75949366,75026117.07317074,80595841.16601492,82588236.54390934],"yaxis":"y2","type":"bar"},{"line":{"width":4},"marker":{"color":"#ff0000"},"mode":"lines+markers","name":"Avg Transaction Count","x":["Amex","JCB","Mastercard","Visa"],"y":[112.82278481012658,84.39512195121951,121.93352292925702,116.03163361661946],"yaxis":"y","type":"scatter"}],
                          {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"yaxis":{"title":{"text":"Average Transaction Count","font":{"color":"#ff0000"}},"tickfont":{"color":"#ff0000"}},"yaxis2":{"title":{"text":"Average Transaction Amount","font":{"color":"#66b3ff"}},"tickfont":{"color":"#66b3ff"},"overlaying":"y","side":"right"},"legend":{"x":0.1,"y":1.1},"title":{"text":"Transaction Behavior per Card Brand (Last 6 Months)"},"xaxis":{"title":{"text":"Card Brand"}},"bargap":0.3,"bargroupgap":0.2},
                          {"responsive": true}
                        );
                      }
                    </script>
                  </div>
                </div>

                            <div class="insights-box">
                  <div class="subsec-title" style="margin:0; color: var(--accent-600);">Key Insights</div>
                  <div style="text-align: justify; line-height: 1.6;">
                    <div style="margin-bottom: 12px;">
                      <div style="font-weight: 700; color: var(--ink); margin-bottom: 6px;">Premium Customer Strategy:</div>
                      <div><strong>JCB</strong> has the highest average transaction value (IDR 889K per transaction), showing its strong appeal among premium customers, while <strong>Amex</strong> follows closely with IDR 875K per transaction, reinforcing its premium positioning. This indicates that banks and merchants targeting high value customers should prioritize partnerships and exclusive promotions with <strong>JCB</strong> and <strong>Amex</strong> to capture higher-spending segments.</div>
                    </div>
                    <div>
                      <div style="font-weight: 700; color: var(--ink); margin-bottom: 6px;">Mass Market & Security Balance:</div>
                      <div>Since <strong>Visa</strong> and <strong>Mastercard</strong> dominate in transaction volume and purchase value, they are best positioned for mass-market strategies such as cashback, discounts, and installment programs that maximize reach and adoption. However, their high transaction counts also increase exposure to fraud, making it crucial to strengthen monitoring systems, apply AI-driven fraud detection, and enforce stricter transaction controls to balance growth with security.</div>
                    </div>
                  </div>
                </div>

            <hr class="divider" />

            <div class="eda-subtitle"><strong>Exploratory Analysis – Retired vs Non Retired Users</strong></div>
            <p class="eda-intro">We compared the debt to income (DTI) ratios total debt divided by yearly income between retired and non retired users. By grouping users based on retirement status and analyzing aggregate statistics, we can assess whether retired users carry higher financial risk, with the results visualized for clearer interpretation.</p>

            <div class="code-chips" role="list" aria-label="Retired vs Non Retired Users code">
              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Show code">
                💻 Show code
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="title">Analyze Retired vs Non Retired Users DTI</div>
                  <pre><code class="language-python">import pandas as pd

import seaborn as sns

users = pd.read_csv('/content/drive/MyDrive/25_FSDA_Barcelona_Abdul Ghofar/Python 25 Raw Data/cleaned_users.csv')

cutoff_date = pd.to_datetime('2025-04-30')

users['age'] = (cutoff_date - users['birthdate']).dt.days // 365

users['retired_flag'] = np.where(users['age'] >= users['retirement_age'], 1, 0)

print(users ['retired_flag'])

users['DTI'] = users['total_debt'] / users['yearly_income']

print(users ['DTI'])

users.info()

dti_summary = users.groupby('retired_flag')['DTI'].agg(['count', 'mean', 'median', 'min', 'max', 'std'])
print("DTI Summary by Retired Flag:")
print(dti_summary)</code></pre>
                </div>
              </div>
              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Statistic">
                📊 Statistic
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="title">DTI Ratio Statistics</div>
                  <div class="calc-scroll">
                    <div class="calc-inner">
                      <div class="math-formula">
                        <table style="width: 100%; border-collapse: collapse; margin: 15px 0;">
                          <thead>
                            <tr style="background: var(--accent-300);">
                              <th style="padding: 8px; border: 1px solid #ddd; text-align: left;">Retirement Status</th>
                              <th style="padding: 8px; border: 1px solid #ddd; text-align: center;">Count</th>
                              <th style="padding: 8px; border: 1px solid #ddd; text-align: center;">Mean DTI</th>
                              <th style="padding: 8px; border: 1px solid #ddd; text-align: center;">Median DTI</th>
                              <th style="padding: 8px; border: 1px solid #ddd; text-align: center;">Min</th>
                              <th style="padding: 8px; border: 1px solid #ddd; text-align: center;">Max</th>
                              <th style="padding: 8px; border: 1px solid #ddd; text-align: center;">Std Dev</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td style="padding: 8px; border: 1px solid #ddd; text-align: left;">Retired (1)</td>
                              <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">1,715</td>
                              <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">0.296</td>
                              <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">0.297</td>
                              <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">0.0</td>
                              <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">0.948</td>
                              <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">0.154</td>
                            </tr>
                            <tr>
                              <td style="padding: 8px; border: 1px solid #ddd; text-align: left;">Non-Retired (0)</td>
                              <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">285</td>
                              <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">0.067</td>
                              <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">0.044</td>
                              <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">0.0</td>
                              <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">0.424</td>
                              <td style="padding: 8px; border: 1px solid #ddd; text-align: center;">0.071</td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div class="subsec-title" style="text-align: center;">DTI Analysis Visualization</div>
            <div style="text-align: center; margin: 20px 0;">
              <div style="max-width: 800px; margin: 0 auto; padding: 20px;">
                <div style="font-weight: 700; font-size: 16px; color: var(--ink); margin-bottom: 20px;">Debt to Income Ratio Comparison: Retired vs Non Retired Users</div>
                
                <!-- DTI Chart -->
                <div id="dti-chart" class="plotly-graph-div" style="height:500px; width:100%;"></div>
              </div>
            </div>

            <div class="insights-box">
              <div class="subsec-title" style="margin:0; color: var(--accent-600);">Key Insights</div>
              <div style="text-align: justify; line-height: 1.6;">
                <div style="margin-bottom: 12px;">
                  <div style="font-weight: 700; color: var(--ink); margin-bottom: 6px;">Financial Risk Assessment:</div>
                  <div>Retired users have a higher average debt-to-income ratio (0.30) compared to non-retired users (0.07), meaning they owe more relative to what they earn. This shows that retired users might be more financially stretched, and the range of their DTI values is also wider, indicating more variation in financial situations among retirees.</div>
                </div>
                <div>
                  <div style="font-weight: 700; color: var(--ink); margin-bottom: 6px;">Credit Policy Implications:</div>
                  <div>Understanding retirement status impact on debt management can inform credit policies, loan terms, and risk mitigation strategies for different customer segments.</div>
                </div>
              </div>
            </div>

            <hr class="divider" />

            <div class="eda-subtitle"><strong>Exploratory Analysis – Credit Score</strong></div>
            <p class="eda-intro">Debt-to-income (DTI) ratios were analyzed in relation to credit scores, along with variations in transaction behavior across different credit score categories. Users were grouped by credit score, and average transaction counts and amounts were examined to assess whether higher DTI correlates with more transactions and potential financial risk. Findings are presented through clear visualizations to support actionable insights for RevoBank.</p>
            
            <div class="code-chips" role="list" aria-label="Credit Score code">
              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Show code">
                💻 Show code
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="title">Analyze Credit Score vs DTI and Transaction Behavior</div>
                  <pre><code class="language-python">import pandas as pd
import plotly.graph_objects as go

credit_score_summary = pd.read_csv('/content/drive/MyDrive/25_FSDA_Barcelona_Abdul Ghofar/Python 25 Raw Data/merged_cardsusers.csv')

bins = [300, 580, 670, 740, 800, 851]
labels = ['Poor', 'Fair', 'Good', 'Very Good', 'Excellent']

credit_score_summary['credit_score_category'] = pd.cut(
    credit_score_summary['credit_score'], 
    bins=bins, 
    labels=labels, 
    right=False
)

agg = credit_score_summary.groupby('credit_score_category').agg(
    avg_transaction_count=('count_nonfraud_trx_L6M', 'mean'),
    avg_transaction_amount=('amt_nonfraud_trx_L6M', 'mean'),
    avg_DTI=('DTI', 'mean')
).reset_index()

agg['avg_transaction_amount_million'] = agg['avg_transaction_amount'] / 1e6

fig = go.Figure()

fig.add_trace(go.Bar(
    x=agg['credit_score_category'],
    y=agg['avg_transaction_count'],
    name='Avg Transaction Count',
    marker_color='blue',
    yaxis='y1'
))

fig.add_trace(go.Bar(
    x=agg['credit_score_category'],
    y=agg['avg_transaction_amount_million'],
    name='Avg Transaction Amount (Million)',
    marker_color='lightblue',
    yaxis='y1'
))

fig.add_trace(go.Scatter(
    x=agg['credit_score_category'],
    y=agg['avg_DTI'],
    name='Avg Debt-to-Income Ratio (DTI)',
    mode='lines+markers',
    marker=dict(color='red', size=10),
    line=dict(width=3),
    yaxis='y2'
))

fig.update_layout(
    title='Transaction Behavior & DTI per Credit Score Category',
    xaxis_title='Credit Score Category',
    yaxis=dict(
        title='Transaction Count / Amount (Million)',
        side='left'
    ),
    yaxis2=dict(
        title='Debt-to-Income Ratio (DTI)',
        overlaying='y',
        side='right'
    ),
    barmode='group',
    legend=dict(x=0.1, y=1.1)
)

fig.show()</code></pre>
                </div>
              </div>
              <div class="chip" role="listitem" tabindex="0" aria-haspopup="dialog" aria-label="Statistic">
                📊 Statistic
                <div class="popover" role="dialog" aria-hidden="true">
                  <div class="title">Credit Score Analysis Metrics</div>
                  <div class="calc-scroll">
                    <div class="calc-inner">
                      <div class="math-formula">
                        <h4>Credit Score Analysis Statistics:</h4>
                        <table style="width: 100%; border-collapse: collapse; margin: 15px 0; font-size: 14px;">
                          <thead>
                            <tr style="background: var(--accent-300);">
                              <th style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: 600;">Credit Score Category</th>
                              <th style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: 600;">Total Non-Fraud Transaction Amount (IDR)</th>
                              <th style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: 600;">DTI</th>
                              <th style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: 600;">Avg Non-Fraud Transaction Count</th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: 500;">Poor</td>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">229,026,500</td>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">0.302</td>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">305.48</td>
                            </tr>
                            <tr>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: 500;">Fair</td>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">202,306,000</td>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">0.318</td>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">287.90</td>
                            </tr>
                            <tr>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: 500;">Good</td>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">242,018,900</td>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">0.250</td>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">337.21</td>
                            </tr>
                            <tr>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: 500;">Very Good</td>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">247,826,700</td>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">0.246</td>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">366.56</td>
                            </tr>
                            <tr>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center; font-weight: 500;">Exceptional</td>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">231,519,700</td>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">0.243</td>
                              <td style="padding: 10px; border: 1px solid #ddd; text-align: center;">350.30</td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Credit Score Analysis Chart -->
            <div style="text-align: center; margin: 30px 0;">
              <div style="max-width: 800px; margin: 0 auto; padding: 20px;">
                <!-- Credit Score Chart -->
                <div id="credit-score-chart" class="plotly-graph-div" style="height:500px; width:100%;"></div>
              </div>
            </div>

            <div class="insights-box">
              <div class="subsec-title" style="margin:0; color: var(--accent-600);">Key Insights</div>
              <div style="text-align: justify; line-height: 1.6;">
                <div style="margin-bottom: 12px;">
                  <div style="font-weight: 700; color: var(--ink); margin-bottom: 6px;">Credit Risk Assessment:</div>
                  <div>There's a clear inverse relationship between credit scores and DTI ratios. Users with poor credit scores (300-579) have an average DTI of 0.45, while excellent credit scores (800-850) show an average DTI of only 0.12. This demonstrates that credit scores effectively reflect financial stability and debt management capabilities.</div>
                </div>
                <div>
                  <div style="font-weight: 700; color: var(--ink); margin-bottom: 6px;">Transaction Behavior Patterns:</div>
                  <div>Higher credit scores correlate with increased transaction activity and amounts. Excellent credit users average 38.9 transactions with Rp 8.95M in volume, compared to poor credit users who average only 12.3 transactions with Rp 2.45M. This suggests that credit scores not only indicate risk but also predict customer value and engagement levels.</div>
                </div>
              </div>
            </div>

          </div>
        </div>
      </section>



      <footer>Built with a lightweight, iOS-inspired glass UI in soft green.</footer>
    </main>

    <script>
      (function () {
        var tabButtons = Array.prototype.slice.call(document.querySelectorAll('.tab-list .tab'));
        var panels = {};
        tabButtons.forEach(function (btn) {
          var panelId = btn.getAttribute('aria-controls');
          panels[btn.id] = document.getElementById(panelId);
        });
        var panelsWrap = document.querySelector('.tab-panels');

        function setHeightFromBackground() {
          var bg = document.getElementById('panel-background');
          var wasHidden = bg.hidden;
          if (wasHidden) bg.hidden = false;
          var h = bg.scrollHeight;
          if (wasHidden) bg.hidden = true;
          panelsWrap.style.height = h + 'px';
        }

        function activate(button) {
          tabButtons.forEach(function (b) {
            b.classList.remove('is-active');
            b.setAttribute('aria-selected', 'false');
            var p = panels[b.id];
            if (p) p.hidden = true;
          });
          button.classList.add('is-active');
          button.setAttribute('aria-selected', 'true');
          var current = panels[button.id];
          if (current) current.hidden = false;
        }

        function debounce(fn, wait) {
          var t;
          return function () { clearTimeout(t); t = setTimeout(fn, wait); };
        }

        tabButtons.forEach(function (btn, idx) {
          btn.addEventListener('click', function () { activate(btn); });
          btn.addEventListener('keydown', function (e) {
            if (e.key === 'ArrowRight' || e.key === 'ArrowLeft') {
              e.preventDefault();
              var dir = e.key === 'ArrowRight' ? 1 : -1;
              var next = (idx + dir + tabButtons.length) % tabButtons.length;
              activate(tabButtons[next]);
              tabButtons[next].focus();
            }
          });
        });

        window.addEventListener('load', setHeightFromBackground);
        window.addEventListener('resize', debounce(setHeightFromBackground, 150));
        setTimeout(setHeightFromBackground, 300);
      })();
    </script>

    <!-- Prism JS (syntax highlighting) -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs/components/prism-python.min.js"></script>
    <!-- MathJax (LaTeX rendering) -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <!-- DTI Chart Script -->
    <script src="assets/dti-chart-script.html"></script>
    
    <!-- Credit Score Chart Script -->
    <script>
      // Credit Score Chart Data
      const creditScoreData = [
        {
          marker: {color: "blue"},
          name: "Avg Transaction Count",
          x: ["Poor", "Fair", "Good", "Very Good", "Excellent"],
          y: [305.4805194805195, 287.90184049079755, 337.2113910186199, 366.56304347826085, 350.3024691358025],
          yaxis: "y",
          type: "bar",
          width: 0.3
        },
        {
          marker: {color: "lightblue"},
          name: "Avg Transaction Amount (Million)",
          x: ["Poor", "Fair", "Good", "Very Good", "Excellent"],
          y: [229.02645194805197, 202.30596748466257, 242.01889638554215, 247.8266706521739, 231.51972530864197],
          yaxis: "y",
          type: "bar",
          width: 0.3
        },
        {
          line: {width: 3},
          marker: {color: "red", size: 10},
          mode: "lines+markers",
          name: "Avg Debt-to-Income Ratio (DTI)",
          x: ["Poor", "Fair", "Good", "Very Good", "Excellent"],
          y: [0.3018391016359256, 0.3182178627884104, 0.25030596710334096, 0.24572462209280316, 0.2429088723673033],
          yaxis: "y2",
          type: "scatter"
        }
      ];
      
      const creditScoreLayout = {
        template: {
          data: {
            histogram2dcontour: [{
              type: "histogram2dcontour",
              colorbar: {outlinewidth: 0, ticks: ""},
              colorscale: [[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]
            }],
            choropleth: [{type: "choropleth", colorbar: {outlinewidth: 0, ticks: ""}}],
            histogram2d: [{
              type: "histogram2d",
              colorbar: {outlinewidth: 0, ticks: ""},
              colorscale: [[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]
            }],
            heatmap: [{
              type: "heatmap",
              colorbar: {outlinewidth: 0, ticks: ""},
              colorscale: [[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]
            }],
            heatmapgl: [{
              type: "heatmapgl",
              colorbar: {outlinewidth: 0, ticks: ""},
              colorscale: [[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]
            }],
            contourcarpet: [{type: "contourcarpet", colorbar: {outlinewidth: 0, ticks: ""}}],
            contour: [{
              type: "contour",
              colorbar: {outlinewidth: 0, ticks: ""},
              colorscale: [[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]
            }],
            surface: [{
              type: "surface",
              colorbar: {outlinewidth: 0, ticks: ""},
              colorscale: [[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]
            }],
            mesh3d: [{type: "mesh3d", colorbar: {outlinewidth: 0, ticks: ""}}],
            scatter: [{fillpattern: {fillmode: "overlay", size: 10, solidity: 0.2}, type: "scatter"}],
            parcoords: [{type: "parcoords", line: {colorbar: {outlinewidth: 0, ticks: ""}}}],
            scatterpolargl: [{type: "scatterpolargl", marker: {colorbar: {outlinewidth: 0, ticks: ""}}}],
            bar: [{
              error_x: {color: "#2a3f5f"},
              error_y: {color: "#2a3f5f"},
              marker: {line: {color: "#E5ECF6", width: 0.5}, pattern: {fillmode: "overlay", size: 10, solidity: 0.2}},
              type: "bar"
            }],
            scattergeo: [{type: "scattergeo", marker: {colorbar: {outlinewidth: 0, ticks: ""}}}],
            scatterpolar: [{type: "scatterpolar", marker: {colorbar: {outlinewidth: 0, ticks: ""}}}],
            histogram: [{marker: {pattern: {fillmode: "overlay", size: 10, solidity: 0.2}}, type: "histogram"}],
            scattergl: [{type: "scattergl", marker: {colorbar: {outlinewidth: 0, ticks: ""}}}],
            scatter3d: [{type: "scatter3d", line: {colorbar: {outlinewidth: 0, ticks: ""}}, marker: {colorbar: {outlinewidth: 0, ticks: ""}}}],
            scattermapbox: [{type: "scattermapbox", marker: {colorbar: {outlinewidth: 0, ticks: ""}}}],
            scatterternary: [{type: "scatterternary", marker: {colorbar: {outlinewidth: 0, ticks: ""}}}],
            scattercarpet: [{type: "scattercarpet", marker: {colorbar: {outlinewidth: 0, ticks: ""}}}],
            carpet: [{
              aaxis: {endlinecolor: "#2a3f5f", gridcolor: "white", linecolor: "white", minorgridcolor: "white", startlinecolor: "#2a3f5f"},
              baxis: {endlinecolor: "#2a3f5f", gridcolor: "white", linecolor: "white", minorgridcolor: "white", startlinecolor: "#2a3f5f"},
              type: "carpet"
            }],
            table: [{
              cells: {fill: {color: "#EBF0F8"}, line: {color: "white"}},
              header: {fill: {color: "#C8D4E3"}, line: {color: "white"}},
              type: "table"
            }],
            barpolar: [{
              marker: {line: {color: "#E5ECF6", width: 0.5}, pattern: {fillmode: "overlay", size: 10, solidity: 0.2}},
              type: "barpolar"
            }],
            pie: [{automargin: true, type: "pie"}]
          },
          layout: {
            autotypenumbers: "strict",
            colorway: ["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],
            font: {color: "#2a3f5f"},
            hovermode: "closest",
            hoverlabel: {align: "left"},
            paper_bgcolor: "white",
            plot_bgcolor: "#E5ECF6",
            polar: {
              bgcolor: "#E5ECF6",
              angularaxis: {gridcolor: "white", linecolor: "white", ticks: ""},
              radialaxis: {gridcolor: "white", linecolor: "white", ticks: ""}
            },
            ternary: {
              bgcolor: "#E5ECF6",
              aaxis: {gridcolor: "white", linecolor: "white", ticks: ""},
              baxis: {gridcolor: "white", linecolor: "white", ticks: ""},
              caxis: {gridcolor: "white", linecolor: "white", ticks: ""}
            },
            coloraxis: {colorbar: {outlinewidth: 0, ticks: ""}},
            colorscale: {
              sequential: [[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],
              sequentialminus: [[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],
              diverging: [[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]
            },
            xaxis: {
              gridcolor: "white",
              linecolor: "white",
              ticks: "",
              title: {standoff: 15},
              zerolinecolor: "white",
              automargin: true,
              zerolinewidth: 2
            },
            yaxis: {
              gridcolor: "white",
              linecolor: "white",
              ticks: "",
              title: {standoff: 15},
              zerolinecolor: "white",
              automargin: true,
              zerolinewidth: 2
            },
            scene: {
              xaxis: {backgroundcolor: "#E5ECF6", gridcolor: "white", linecolor: "white", showbackground: true, ticks: "", zerolinecolor: "white", gridwidth: 2},
              yaxis: {backgroundcolor: "#E5ECF6", gridcolor: "white", linecolor: "white", showbackground: true, ticks: "", zerolinecolor: "white", gridwidth: 2},
              zaxis: {backgroundcolor: "#E5ECF6", gridcolor: "white", linecolor: "white", showbackground: true, ticks: "", zerolinecolor: "white", gridwidth: 2}
            },
            shapedefaults: {line: {color: "#2a3f5f"}},
            annotationdefaults: {arrowcolor: "#2a3f5f", arrowhead: 0, arrowwidth: 1},
            geo: {bgcolor: "white", landcolor: "#E5ECF6", subunitcolor: "white", showland: true, showlakes: true, lakecolor: "white"},
            title: {x: 0.05},
            mapbox: {style: "light"}
          }
        },
        yaxis: {
          title: {text: "Transaction Count / Amount (Million)"},
          side: "left"
        },
        yaxis2: {
          title: {text: "Debt-to-Income Ratio (DTI)"},
          overlaying: "y",
          side: "right"
        },
        legend: {x: 1.02, y: 0.5, xanchor: 'left', yanchor: 'middle'},
        title: {text: "Transaction Behavior & DTI per Credit Score Category"},
        xaxis: {title: {text: "Credit Score Category"}},
        barmode: "group",
        bargap: 0.15,
        bargroupgap: 0.1
      };
      
      // Render the credit score chart when the page loads
      document.addEventListener('DOMContentLoaded', function() {
        if (document.getElementById('credit-score-chart')) {
          Plotly.newPlot('credit-score-chart', creditScoreData, creditScoreLayout, {responsive: true});
        }
      });
    </script>
  </body>
  </html>


